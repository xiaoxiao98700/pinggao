<!-- 内容区：左右两部分 -->
            <div class="price-config-content">
                <!-- 左侧：地理位置树形菜单 -->
                <aside class="price-config-sidebar">
                    <div class="tree-search">
                        <input type="text" placeholder="请输入关键词查询" class="tree-search-input">
                    </div>
                    <div class="tree-menu" id="locationTree">
                        <!-- 北京市 -->
                        <div class="tree-node">
                            <div class="tree-node-item expanded" data-node="beijing">
                                <span class="tree-arrow">▼</span>
                                <span class="tree-label">北京市</span>
                            </div>
                            <div class="tree-children">
                                <div class="tree-node-item active" data-node="beijing-districts">
                                    <span class="tree-label">市辖区</span>
                                </div>
                                <div class="tree-node-item" data-node="beijing-counties">
                                    <span class="tree-label">县</span>
                                </div>
                            </div>
                        </div>
                        <!-- 天津市 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="tianjin">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">天津市</span>
                            </div>
                        </div>
                        <!-- 河北省 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="hebei">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">河北省</span>
                            </div>
                        </div>
                        <!-- 山西省 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="shanxi">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">山西省</span>
                            </div>
                        </div>
                        <!-- 内蒙古自治区 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="neimenggu">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">内蒙古自治区</span>
                            </div>
                        </div>
                        <!-- 辽宁省 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="liaoning">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">辽宁省</span>
                            </div>
                        </div>
                        <!-- 吉林省 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="jilin">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">吉林省</span>
                            </div>
                        </div>
                        <!-- 黑龙江省 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="heilongjiang">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">黑龙江省</span>
                            </div>
                        </div>
                        <!-- 上海市 -->
                        <div class="tree-node">
                            <div class="tree-node-item" data-node="shanghai">
                                <span class="tree-arrow">▶</span>
                                <span class="tree-label">上海市</span>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- 右侧：电价时段配置表格 -->
                <div class="price-config-main">
                    <!-- 操作按钮栏 -->
                    <div class="price-config-actions">
                        <button class="price-btn price-btn-new">
                            <span class="btn-icon">+</span>
                            新建
                        </button>
                        <button class="price-btn price-btn-reference">
                            <span class="btn-icon">↗</span>
                            引用
                        </button>
                        <button class="price-btn price-btn-edit">
                            <span class="btn-icon">✎</span>
                            编辑
                        </button>
                        <button class="price-btn price-btn-delete">
                            <span class="btn-icon">🗑</span>
                            删除
                        </button>
                    </div>

                    <!-- 数据表格 -->
                    <div class="price-config-table-wrapper">
                        <table class="price-config-table">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>名称</th>
                                    <th>时段时长</th>
                                    <th>电价（元）</th>
                                </tr>
                            </thead>
                            <tbody id="priceConfigTableBody">
                                <tr>
                                    <td>1</td>
                                    <td>尖峰</td>
                                    <td>00:00-01:00</td>
                                    <td>0.85</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>峰电</td>
                                    <td>01:00-02:00</td>
                                    <td>0.65</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>平电</td>
                                    <td>02:00-00:00</td>
                                    <td>0.45</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

<div class="modal-overlay" id="newPriceModal" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">新增</h3>
                <button class="modal-close" onclick="closeNewPriceModal()">×</button>
            </div>
            <div class="modal-body">
                <!-- 省份和城市选择 -->
                <div class="modal-province-selector" style="margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: start;">
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label class="modal-province-label" style="font-weight: 500; color: #333;">省份：</label>
                            <select class="modal-province-select" id="modalProvinceSelect" style="width: 100%; padding: 8px 12px; border: 1px solid #d9d9d9; border-radius: 4px; font-size: 14px;">
                                <option value="">请选择省份</option>
                                <option value="beijing">北京市</option>
                                <option value="tianjin">天津市</option>
                                <option value="hebei">河北省</option>
                                <option value="shanxi">山西省</option>
                                <option value="neimenggu">内蒙古自治区</option>
                                <option value="liaoning">辽宁省</option>
                                <option value="jilin">吉林省</option>
                                <option value="heilongjiang">黑龙江省</option>
                                <option value="shanghai">上海市</option>
                                <option value="jiangsu">江苏省</option>
                                <option value="zhejiang">浙江省</option>
                                <option value="anhui">安徽省</option>
                                <option value="fujian">福建省</option>
                                <option value="jiangxi">江西省</option>
                                <option value="shandong">山东省</option>
                                <option value="henan">河南省</option>
                                <option value="hubei">湖北省</option>
                                <option value="hunan">湖南省</option>
                                <option value="guangdong">广东省</option>
                                <option value="guangxi">广西壮族自治区</option>
                                <option value="hainan">海南省</option>
                                <option value="chongqing">重庆市</option>
                                <option value="sichuan">四川省</option>
                                <option value="guizhou">贵州省</option>
                                <option value="yunnan">云南省</option>
                                <option value="xizang">西藏自治区</option>
                                <option value="shaanxi">陕西省</option>
                                <option value="gansu">甘肃省</option>
                                <option value="qinghai">青海省</option>
                                <option value="ningxia">宁夏回族自治区</option>
                                <option value="xinjiang">新疆维吾尔自治区</option>
                            </select>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label class="modal-province-label" style="font-weight: 500; color: #333;">市/区：</label>
                            <select class="modal-province-select" id="modalCitySelect" disabled style="width: 100%; padding: 8px 12px; border: 1px solid #d9d9d9; border-radius: 4px; font-size: 14px;">
                                <option value="">请先选择省份</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <table class="modal-table">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>电价类型</th>
                            <th>电价</th>
                            <th colspan="3">时段</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="modalTableBody">
                        <tr>
                            <td>1</td>
                            <td>尖峰</td>
                            <td><input type="number" class="modal-input" value="1.00" step="0.01"></td>
                            <td><input type="time" class="modal-input" placeholder="起始时间"></td>
                            <td class="modal-separator">至</td>
                            <td><input type="time" class="modal-input" placeholder="终止时间"></td>
                            <td><a href="javascript:void(0)" class="add-time-link" onclick="addTimeRow(this)">添加时段</a></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>峰电</td>
                            <td><input type="number" class="modal-input" value="1.00" step="0.01"></td>
                            <td><input type="time" class="modal-input" placeholder="起始时间"></td>
                            <td class="modal-separator">至</td>
                            <td><input type="time" class="modal-input" placeholder="终止时间"></td>
                            <td><a href="javascript:void(0)" class="add-time-link" onclick="addTimeRow(this)">添加时段</a></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>平电</td>
                            <td><input type="number" class="modal-input" value="1.00" step="0.01"></td>
                            <td><input type="time" class="modal-input" placeholder="起始时间"></td>
                            <td class="modal-separator">至</td>
                            <td><input type="time" class="modal-input" placeholder="终止时间"></td>
                            <td><a href="javascript:void(0)" class="add-time-link" onclick="addTimeRow(this)">添加时段</a></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>谷电</td>
                            <td><input type="number" class="modal-input" value="1.00" step="0.01"></td>
                            <td><input type="time" class="modal-input" placeholder="起始时间"></td>
                            <td class="modal-separator">至</td>
                            <td><input type="time" class="modal-input" placeholder="终止时间"></td>
                            <td><a href="javascript:void(0)" class="add-time-link" onclick="addTimeRow(this)">添加时段</a></td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>深谷</td>
                            <td><input type="number" class="modal-input" value="1.00" step="0.01"></td>
                            <td><input type="time" class="modal-input" placeholder="起始时间"></td>
                            <td class="modal-separator">至</td>
                            <td><input type="time" class="modal-input" placeholder="终止时间"></td>
                            <td><a href="javascript:void(0)" class="add-time-link" onclick="addTimeRow(this)">添加时段</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" onclick="closeNewPriceModal()">取消</button>
                <button class="modal-btn modal-btn-confirm" onclick="saveNewPrice()">确定</button>
            </div>
        </div>

<script src="script.js"></script>

<script>
        // 电价时段配置页面专用脚本
        (function() {
            // 树形菜单展开/折叠功能
            const treeNodes = document.querySelectorAll('.tree-node-item[data-node]');
            treeNodes.forEach(node => {
                node.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const parentNode = this.closest('.tree-node');
                    const children = parentNode.querySelector('.tree-children');
                    
                    if (children) {
                        // 有子节点，切换展开/折叠
                        if (this.classList.contains('expanded')) {
                            this.classList.remove('expanded');
                            this.querySelector('.tree-arrow').textContent = '▶';
                            children.style.display = 'none';
                        } else {
                            this.classList.add('expanded');
                            this.querySelector('.tree-arrow').textContent = '▼';
                            children.style.display = 'block';
                        }
                    } else {
                        // 没有子节点，选中该项
                        document.querySelectorAll('.tree-node-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        this.classList.add('active');
                    }
                });
            });

            // 搜索功能
            const searchInput = document.querySelector('.tree-search-input');
            if (searchInput) {
                searchInput.addEventListener('input', function(e) {
                    const keyword = e.target.value.toLowerCase();
                    const allNodes = document.querySelectorAll('.tree-node-item');
                    
                    allNodes.forEach(node => {
                        const label = node.querySelector('.tree-label').textContent.toLowerCase();
                        const treeNode = node.closest('.tree-node');
                        
                        if (keyword === '' || label.includes(keyword)) {
                            treeNode.style.display = 'block';
                        } else {
                            treeNode.style.display = 'none';
                        }
                    });
                });
            }

            // 表格行选中功能
            const tableRows = document.querySelectorAll('#priceConfigTableBody tr');
            tableRows.forEach(row => {
                row.addEventListener('click', function() {
                    tableRows.forEach(r => r.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });

            // 操作按钮事件
            const btnNew = document.querySelector('.price-btn-new');
            const btnReference = document.querySelector('.price-btn-reference');
            const btnEdit = document.querySelector('.price-btn-edit');
            const btnDelete = document.querySelector('.price-btn-delete');

            if (btnNew) {
                btnNew.addEventListener('click', function() {
                    openNewPriceModal();
                });
            }

            if (btnReference) {
                btnReference.addEventListener('click', function() {
                    alert('引用功能待实现');
                });
            }

            if (btnEdit) {
                btnEdit.addEventListener('click', function() {
                    const selectedRow = document.querySelector('#priceConfigTableBody tr.selected');
                    if (selectedRow) {
                        alert('编辑功能待实现');
                    } else {
                        alert('请先选择要编辑的行');
                    }
                });
            }

            if (btnDelete) {
                btnDelete.addEventListener('click', function() {
                    const selectedRow = document.querySelector('#priceConfigTableBody tr.selected');
                    if (selectedRow) {
                        if (confirm('确定要删除选中的记录吗？')) {
                            selectedRow.remove();
                            // 重新编号
                            const rows = document.querySelectorAll('#priceConfigTableBody tr');
                            rows.forEach((row, index) => {
                                row.querySelector('td:first-child').textContent = index + 1;
                            });
                        }
                    } else {
                        alert('请先选择要删除的行');
                    }
                });
            }
        })();

        // 弹窗相关函数 - 全部定义到全局作用域
        window.openNewPriceModal = function() {
            const modal = document.getElementById('newPriceModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        };

        window.closeNewPriceModal = function() {
            const modal = document.getElementById('newPriceModal');
            if (modal) {
                modal.style.display = 'none';
            }
        };

        window.saveNewPrice = function() {
            const provinceSelect = document.getElementById('modalProvinceSelect');
            const citySelect = document.getElementById('modalCitySelect');
            const province = provinceSelect.options[provinceSelect.selectedIndex].text;
            const city = citySelect.options[citySelect.selectedIndex].text;
            
            if (!provinceSelect.value) {
                alert('请选择省份');
                return;
            }
            if (!citySelect.value) {
                alert('请选择城市');
                return;
            }
            
            console.log('保存省份:', province, '城市:', city);
            alert(`保存成功：${province} - ${city}`);
            window.closeNewPriceModal();
        };

        window.addTimeRow = function(link) {
            const row = link.closest('tr');
            const tbody = row.parentNode;
            const newRow = document.createElement('tr');
            const rowIndex = row.rowIndex;
            
            newRow.innerHTML = `
                <td></td>
                <td></td>
                <td></td>
                <td><input type="time" class="modal-input" placeholder="起始时间"></td>
                <td class="modal-separator">至</td>
                <td><input type="time" class="modal-input" placeholder="终止时间"></td>
                <td><a href="javascript:void(0)" class="remove-time-link" onclick="removeTimeRow(this)">删除时段</a></td>
            `;
            
            tbody.insertBefore(newRow, row.nextSibling);
        };

        window.removeTimeRow = function(link) {
            const row = link.closest('tr');
            row.remove();
        };
        
        // 省市联动数据
        const cityData = {
            'beijing': ['北京市'],
            'tianjin': ['天津市'],
            'hebei': ['石家庄市', '唐山市', '秦皇岛市', '邯郸市', '邢台市', '保定市', '张家口市', '承德市', '沧州市', '廊坊市', '衡水市'],
            'shanxi': ['太原市', '大同市', '阳泉市', '长治市', '晋城市', '朔州市', '晋中市', '运城市', '忻州市', '临汾市', '吕梁市'],
            'neimenggu': ['呼和浩特市', '包头市', '乌海市', '赤峰市', '通辽市', '鄂尔多斯市', '呼伦贝尔市', '巴彦淖尔市', '乌兰察布市'],
            'liaoning': ['沈阳市', '大连市', '鞍山市', '抚顺市', '本溪市', '丹东市', '锦州市', '营口市', '阜新市', '辽阳市', '盘锦市', '铁岭市', '朝阳市', '葫芦岛市'],
            'jilin': ['长春市', '吉林市', '四平市', '辽源市', '通化市', '白山市', '松原市', '白城市', '延边朝鲜族自治州'],
            'heilongjiang': ['哈尔滨市', '齐齐哈尔市', '鸡西市', '鹤岗市', '双鸭山市', '大庆市', '伊春市', '佳木斯市', '七台河市', '牡丹江市', '黑河市', '绥化市', '大兴安岭地区'],
            'shanghai': ['上海市'],
            'jiangsu': ['南京市', '无锡市', '徐州市', '常州市', '苏州市', '南通市', '连云港市', '淮安市', '盐城市', '扬州市', '镇江市', '泰州市', '宿迁市'],
            'zhejiang': ['杭州市', '宁波市', '温州市', '嘉兴市', '湖州市', '绍兴市', '金华市', '衢州市', '舟山市', '台州市', '丽水市'],
            'anhui': ['合肥市', '芜湖市', '蚌埠市', '淮南市', '马鞍山市', '淮北市', '铜陵市', '安庆市', '黄山市', '滁州市', '阜阳市', '宿州市', '六安市', '亳州市', '池州市', '宣城市'],
            'fujian': ['福州市', '厦门市', '莆田市', '三明市', '泉州市', '漳州市', '南平市', '龙岩市', '宁德市'],
            'jiangxi': ['南昌市', '景德镇市', '萍乡市', '九江市', '新余市', '鹰潭市', '赣州市', '吉安市', '宜春市', '抚州市', '上饶市'],
            'shandong': ['济南市', '青岛市', '淄博市', '枣庄市', '东营市', '烟台市', '潍坊市', '济宁市', '泰安市', '威海市', '日照市', '临沂市', '德州市', '聊城市', '滨州市', '菏泽市'],
            'henan': ['郑州市', '开封市', '洛阳市', '平顶山市', '安阳市', '鹤壁市', '新乡市', '焦作市', '濮阳市', '许昌市', '漯河市', '三门峡市', '南阳市', '商丘市', '信阳市', '周口市', '驻马店市'],
            'hubei': ['武汉市', '黄石市', '十堰市', '宜昌市', '襄阳市', '鄂州市', '荆门市', '孝感市', '荆州市', '黄冈市', '咸宁市', '随州市'],
            'hunan': ['长沙市', '株洲市', '湘潭市', '衡阳市', '邵阳市', '岳阳市', '常德市', '张家界市', '益阳市', '郴州市', '永州市', '怀化市', '娄底市', '湘西土家族苗族自治州'],
            'guangdong': ['广州市', '韶关市', '深圳市', '珠海市', '汕头市', '佛山市', '江门市', '湛江市', '茂名市', '肇庆市', '惠州市', '梅州市', '汕尾市', '河源市', '阳江市', '清远市', '东莞市', '中山市', '潮州市', '揭阳市', '云浮市'],
            'guangxi': ['南宁市', '柳州市', '桂林市', '梧州市', '北海市', '防城港市', '钦州市', '贵港市', '玉林市', '百色市', '贺州市', '河池市', '来宾市', '崇左市'],
            'hainan': ['海口市', '三亚市', '三沙市', '儋州市'],
            'chongqing': ['重庆市'],
            'sichuan': ['成都市', '自贡市', '攀枝花市', '泸州市', '德阳市', '绵阳市', '广元市', '遂宁市', '内江市', '乐山市', '南充市', '眉山市', '宜宾市', '广安市', '达州市', '雅安市', '巴中市', '资阳市'],
            'guizhou': ['贵阳市', '六盘水市', '遵义市', '安顺市', '毕节市', '铜仁市'],
            'yunnan': ['昆明市', '曲靖市', '玉溪市', '保山市', '昭通市', '丽江市', '普洱市', '临沧市'],
            'xizang': ['拉萨市', '日喀则市', '昌都市', '林芝市', '山南市', '那曲市', '阿里地区'],
            'shaanxi': ['西安市', '铜川市', '宝鸡市', '咸阳市', '渭南市', '延安市', '汉中市', '榆林市', '安康市', '商洛市'],
            'gansu': ['兰州市', '嘉峪关市', '金昌市', '白银市', '天水市', '武威市', '张掖市', '平凉市', '酒泉市', '庆阳市', '定西市', '陇南市'],
            'qinghai': ['西宁市', '海东市'],
            'ningxia': ['银川市', '石嘴山市', '吴忠市', '固原市', '中卫市'],
            'xinjiang': ['乌鲁木齐市', '克拉玛依市', '吐鲁番市', '哈密市']
        };
        
        // 省市联动功能
        (function() {
            const provinceSelect = document.getElementById('modalProvinceSelect');
            const citySelect = document.getElementById('modalCitySelect');
            
            if (provinceSelect && citySelect) {
                provinceSelect.addEventListener('change', function() {
                    const province = this.value;
                    citySelect.innerHTML = '<option value="">请选择市/区</option>';
                    
                    if (province && cityData[province]) {
                        citySelect.disabled = false;
                        cityData[province].forEach(city => {
                            const option = document.createElement('option');
                            option.value = city;
                            option.textContent = city;
                            citySelect.appendChild(option);
                        });
                    } else {
                        citySelect.disabled = true;
                        citySelect.innerHTML = '<option value="">请先选择省份</option>';
                    }
                });
            }
        })();
    </script>