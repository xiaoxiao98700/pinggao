<!-- 内容区：左右两部分 -->
            <div class="device-content-wrapper">
                <!-- 左侧：功能位置 -->
                <aside class="device-sidebar">
                    <div class="device-sidebar-title">功能位置</div>
                    <div class="device-project-list">
                        <div class="device-project-item expanded">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▼</span>
                                <span class="device-project-name">天邦酒业</span>
                            </div>
                            <div class="device-project-children">
                                <div class="device-device-item" data-device-id="tianbang-boiler" data-device-name="电极式蒸汽锅炉">电极式蒸汽锅炉</div>
                                <div class="device-device-item active" data-device-id="tianbang-heat-tank" data-device-name="天邦蓄热罐">天邦蓄热罐</div>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">治多供暖项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">迈瑞医疗项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">平顶山尼龙园项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">尚义县供热改造项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">赤峰大虎台风电场项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">新疆昌吉项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">科林项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">哈密项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">平高电气项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">东部投资项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">升浩敦煌项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">上海浦东项目</span>
                            </div>
                        </div>
                        <div class="device-project-item">
                            <div class="device-project-header">
                                <span class="device-project-toggle">▶</span>
                                <span class="device-project-name">新疆中电项目</span>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- 右侧：页签内容 -->
                <div class="device-main-content">
                    <!-- 页面标题 -->
                    <div class="device-page-header">
                        <h2 class="device-title" id="deviceTitle">天邦酒业——天邦蓄热罐</h2>
                    </div>

                    <!-- 页签 -->
                    <div class="device-tabs">
                        <div class="device-tab active" data-tab="monitoring">实时监测</div>
                        <div class="device-tab" data-tab="energy">能耗统计</div>
                        <div class="device-tab" data-tab="configuration">组态</div>
                        <div class="device-tab" data-tab="alarm">告警记录</div>
                        <div class="device-tab" data-tab="analysis">数据分析</div>
                    </div>

                    <!-- 实时监测页签内容 -->
                    <div class="device-tab-content active" id="monitoringContent" data-device="tianbang-heat-tank">
                        <div class="monitoring-grid">
                            <div class="monitoring-item">
                                <label class="monitoring-label">电流1:</label>
                                <input type="text" class="monitoring-input" value="112" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">电流2:</label>
                                <input type="text" class="monitoring-input" value="112" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">电流3:</label>
                                <input type="text" class="monitoring-input" value="112" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">电压1:</label>
                                <input type="text" class="monitoring-input" value="380" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">电压2:</label>
                                <input type="text" class="monitoring-input" value="380" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">电压3:</label>
                                <input type="text" class="monitoring-input" value="380" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">功率1:</label>
                                <input type="text" class="monitoring-input" value="42.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">功率2:</label>
                                <input type="text" class="monitoring-input" value="42.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">功率3:</label>
                                <input type="text" class="monitoring-input" value="42.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">总功率:</label>
                                <input type="text" class="monitoring-input" value="127.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">锅炉温度:</label>
                                <input type="text" class="monitoring-input" value="85" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">出水温度:</label>
                                <input type="text" class="monitoring-input" value="82" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">回水温度:</label>
                                <input type="text" class="monitoring-input" value="75" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">锅炉压力:</label>
                                <input type="text" class="monitoring-input" value="0.6" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">系统压力:</label>
                                <input type="text" class="monitoring-input" value="0.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">水位:</label>
                                <input type="text" class="monitoring-input" value="85" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">流量:</label>
                                <input type="text" class="monitoring-input" value="120" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">频率1:</label>
                                <input type="text" class="monitoring-input" value="50" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">频率2:</label>
                                <input type="text" class="monitoring-input" value="50" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">频率3:</label>
                                <input type="text" class="monitoring-input" value="50" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">运行状态:</label>
                                <input type="text" class="monitoring-input" value="运行中" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">运行时间:</label>
                                <input type="text" class="monitoring-input" value="1250" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">累计运行:</label>
                                <input type="text" class="monitoring-input" value="3650" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">故障代码:</label>
                                <input type="text" class="monitoring-input" value="无" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">报警状态:</label>
                                <input type="text" class="monitoring-input" value="正常" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">能耗统计:</label>
                                <input type="text" class="monitoring-input" value="1250.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">效率:</label>
                                <input type="text" class="monitoring-input" value="95.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">PH值:</label>
                                <input type="text" class="monitoring-input" value="7.2" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">电导率:</label>
                                <input type="text" class="monitoring-input" value="1200" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">溶解氧:</label>
                                <input type="text" class="monitoring-input" value="8.5" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">烟温:</label>
                                <input type="text" class="monitoring-input" value="180" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">排烟温度:</label>
                                <input type="text" class="monitoring-input" value="175" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">进风温度:</label>
                                <input type="text" class="monitoring-input" value="20" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">出风温度:</label>
                                <input type="text" class="monitoring-input" value="85" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">循环泵状态:</label>
                                <input type="text" class="monitoring-input" value="运行" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">补水泵状态:</label>
                                <input type="text" class="monitoring-input" value="停止" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">排污阀状态:</label>
                                <input type="text" class="monitoring-input" value="关闭" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">安全阀状态:</label>
                                <input type="text" class="monitoring-input" value="正常" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">燃烧器状态:</label>
                                <input type="text" class="monitoring-input" value="运行" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">给水阀状态:</label>
                                <input type="text" class="monitoring-input" value="开启" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">蒸汽压力:</label>
                                <input type="text" class="monitoring-input" value="0.8" readonly>
                            </div>
                            <div class="monitoring-item">
                                <label class="monitoring-label">蒸汽温度:</label>
                                <input type="text" class="monitoring-input" value="120" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- 能耗统计页签内容 -->
                    <div class="device-tab-content" id="energyContent" data-device="tianbang-heat-tank">
                        <div class="energy-container">
                            <div class="energy-summary-grid">
                                <div class="energy-card">
                                    <div class="energy-card-title">今日能耗</div>
                                    <div class="energy-card-value">1,250.5 kWh</div>
                                    <div class="energy-card-note">较昨日下降 5%</div>
                                </div>
                                <div class="energy-card">
                                    <div class="energy-card-title">本月累计</div>
                                    <div class="energy-card-value">34,520 kWh</div>
                                    <div class="energy-card-note">同比增长 2.3%</div>
                                </div>
                                <div class="energy-card">
                                    <div class="energy-card-title">平均负荷</div>
                                    <div class="energy-card-value">88.6 kW</div>
                                    <div class="energy-card-note">峰值 120 kW / 谷值 62 kW</div>
                                </div>
                                <div class="energy-card">
                                    <div class="energy-card-title">能耗单价</div>
                                    <div class="energy-card-value">0.67 元/kWh</div>
                                    <div class="energy-card-note">智能浮动价格</div>
                                </div>
                            </div>

                            <div class="energy-chart-panel">
                                <div class="energy-panel">
                                    <div class="panel-header">
                                        <h3>24 小时能耗趋势</h3>
                                        <span class="panel-subtitle">单位：kWh · 更新频率：30 分钟</span>
                                    </div>
                                    <div id="energyChart" style="width: 100%; height: 320px;"></div>
                                    <div class="panel-legend">
                                        <span class="legend-dot peak"></span> 峰时
                                        <span class="legend-dot valley"></span> 谷时
                                        <span class="legend-dot average"></span> 平均值
                                    </div>
                                </div>
                                <div class="energy-peak-card">
                                    <div class="energy-peak-title">峰谷对比</div>
                                    <ul>
                                        <li><strong>峰值能耗</strong>：142.5 kWh（18:00-20:00）</li>
                                        <li><strong>谷值能耗</strong>：68.3 kWh（02:00-04:00）</li>
                                        <li><strong>峰谷差</strong>：74.2 kWh，可削峰填谷</li>
                                        <li><strong>今日日差率</strong>：-6.1%，节省 93 元</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="energy-breakdown-section">
                                <div class="section-header">能耗构成与分布</div>
                                <div class="section-note">按照设备分类、用能类型和高低谷进行归集</div>
                                <div class="energy-breakdown-table-wrapper">
                                    <table class="energy-breakdown-table">
                                        <thead>
                                            <tr>
                                                <th>设备/系统</th>
                                                <th>今日能耗 (kWh)</th>
                                                <th>占比</th>
                                                <th>峰谷比例</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>主锅炉</td>
                                                <td>710.4</td>
                                                <td>56.8%</td>
                                                <td>峰 62% / 谷 38%</td>
                                            </tr>
                                            <tr>
                                                <td>循环泵组</td>
                                                <td>212.1</td>
                                                <td>16.9%</td>
                                                <td>峰 24% / 谷 76%</td>
                                            </tr>
                                            <tr>
                                                <td>补水系统</td>
                                                <td>144.8</td>
                                                <td>11.6%</td>
                                                <td>峰 29% / 谷 71%</td>
                                            </tr>
                                            <tr>
                                                <td>辅助系统</td>
                                                <td>96.2</td>
                                                <td>7.7%</td>
                                                <td>峰 35% / 谷 65%</td>
                                            </tr>
                                            <tr>
                                                <td>照明/办公</td>
                                                <td>86.7</td>
                                                <td>7.0%</td>
                                                <td>峰 40% / 谷 60%</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="energy-suggestion">
                                    <h4>节能建议</h4>
                                    <ul>
                                        <li>偏高的峰值集中在 18:00-20:00，建议提前调度蓄热罐放电。</li>
                                        <li>循环泵在低谷期运行比例超过 70%，可尝试调低频率以缓冲负荷。</li>
                                        <li>补水系统谷值占比较高，检查阀门响应，避免频繁启停。</li>
                                        <li>观察本月能耗增长 2.3%，评估设备基础负荷是否需调整。</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 组态页签内容 -->
                    <div class="device-tab-content" id="configurationContent" data-device="tianbang-heat-tank">
                        <div class="configuration-container">
                            <!-- 左侧控制面板 -->
                            <div class="config-control-panel">
                                <!-- 模式切换 -->
                                <div class="control-mode-tabs">
                                    <div class="control-mode-tab active">本地</div>
                                    <div class="control-mode-tab">远程</div>
                                </div>
                                <div class="control-type-tabs">
                                    <div class="control-type-tab">温度控制</div>
                                    <div class="control-type-tab active">切换控制</div>
                                </div>
                                
                                <!-- 状态列表 -->
                                <div class="control-status-list">
                                    <div class="status-item">
                                        <span class="status-label">锅炉安全</span>
                                        <span class="status-indicator gray"></span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">锅炉停止/运行</span>
                                        <span class="status-indicator green"></span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">锅炉启门/关风</span>
                                        <span class="status-indicator gray"></span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">锅炉运行</span>
                                        <span class="status-indicator green"></span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">锅炉停止/关火完成</span>
                                        <span class="status-indicator gray"></span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">锅炉运行/中</span>
                                        <span class="status-indicator gray"></span>
                                    </div>
                                    <div class="status-item highlight">
                                        <span class="status-label">自动循环</span>
                                        <div class="status-split">
                                            <span class="status-indicator green"></span>
                                            <span class="status-indicator red"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 实际值和设定值 -->
                                <div class="control-values">
                                    <div class="value-item">
                                        <span class="value-label">实际区域循环泵设定值</span>
                                        <span class="value-display">68.9</span>
                                    </div>
                                    <div class="value-item">
                                        <span class="value-label">锅炉实际功率</span>
                                        <span class="value-display">0</span>
                                    </div>
                                </div>
                                
                                <!-- 控制模式状态 -->
                                <div class="control-status-list">
                                    <div class="status-item">
                                        <span class="status-label">锅炉停止/运行控制模式</span>
                                        <span class="status-indicator gray"></span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">锅炉手+温度控制模式</span>
                                        <span class="status-indicator green"></span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">锅炉停止/功率控制</span>
                                        <span class="status-indicator green"></span>
                                    </div>
                                </div>
                                
                                <!-- 停止按钮 -->
                                <button class="btn-stop-boiler">停止锅炉</button>
                            </div>
                            
                            <!-- 右侧组态图 -->
                            <div class="config-diagram-area">
                                <!-- 组态图SVG容器 -->
                                <div class="diagram-container">
                                    <!-- 管道系统 - 重新设计为连贯系统 -->
                                    
                                    <!-- 顶部排气系统 -->
                                    <div class="pipe pipe-vertical" style="right: 240px; top: 40px; height: 70px;"></div>
                                    <div class="pipe-joint" style="right: 240px; top: 110px;"></div>
                                    <div class="pipe pipe-horizontal" style="right: 240px; top: 110px; width: 160px;"></div>
                                    <div class="pipe-arrow pipe-arrow-right" style="right: 120px; top: 107px;"></div>
                                    <div class="valve-symbol open" style="right: 160px; top: 110px;"></div>
                                    <div class="pipe pipe-vertical" style="right: 80px; top: 110px; height: 40px;"></div>
                                    <div class="diagram-label" style="right: 50px; top: 150px;">排气阀</div>
                                    
                                    <!-- W2槽充阀系统（右上） -->
                                    <div class="pipe pipe-vertical" style="right: 80px; top: 40px; height: 80px;"></div>
                                    <div class="valve-symbol" style="right: 80px; top: 120px;"></div>
                                    <div class="pipe pipe-horizontal" style="right: 80px; top: 180px; width: 100px;"></div>
                                    <div class="pipe-arrow pipe-arrow-left" style="right: 140px; top: 177px;"></div>
                                    <div class="pipe pipe-vertical" style="right: 180px; top: 180px; height: 40px;"></div>
                                    <div class="pipe-joint" style="right: 180px; top: 220px;"></div>
                                    <div class="diagram-label" style="right: 30px; top: 20px;">W2槽充阀（氮气）</div>
                                    
                                    <!-- 锅炉顶部蒸汽输出管道 -->
                                    <div class="pipe pipe-horizontal pipe-thick" style="right: 450px; top: 220px; width: 270px;"></div>
                                    <div class="indicator-circle red large" style="position: absolute; right: 460px; top: 215px;"></div>
                                    <div class="indicator-circle red large" style="position: absolute; right: 200px; top: 215px;"></div>
                                    <div class="pipe-arrow pipe-arrow-right" style="right: 300px; top: 215px;"></div>
                                    <div class="diagram-label" style="right: 320px; top: 195px;">蒸汽输出</div>
                                    
                                    <!-- 左侧供水系统 -->
                                    <div class="pipe pipe-vertical pipe-thick" style="left: 120px; top: 180px; height: 100px;"></div>
                                    <div class="pipe-joint" style="left: 120px; top: 180px;"></div>
                                    <div class="pipe-arrow pipe-arrow-down" style="left: 115px; top: 220px;"></div>
                                    <div class="pump-symbol running" style="left: 120px; top: 250px;"></div>
                                    <div class="connection-line horizontal signal" style="left: 30px; top: 250px; width: 70px;"></div>
                                    <div class="pipe pipe-horizontal pipe-thick" style="left: 30px; top: 180px; width: 90px;"></div>
                                    <div class="pipe-arrow pipe-arrow-right" style="left: 60px; top: 175px;"></div>
                                    <div class="diagram-label" style="left: 30px; top: 160px;">供水</div>
                                    
                                    <!-- 左侧回水系统 -->
                                    <div class="pipe pipe-vertical pipe-thick" style="left: 180px; top: 320px; height: 100px;"></div>
                                    <div class="pipe-arrow pipe-arrow-up" style="left: 175px; top: 360px;"></div>
                                    <div class="pump-symbol" style="left: 180px; top: 380px;"></div>
                                    <div class="pipe pipe-horizontal pipe-thick" style="left: 30px; top: 420px; width: 150px;"></div>
                                    <div class="pipe-arrow pipe-arrow-left" style="left: 80px; top: 415px;"></div>
                                    <div class="connection-line horizontal signal" style="left: 30px; top: 380px; width: 130px;"></div>
                                    <div class="diagram-label" style="left: 30px; top: 400px;">回水</div>
                                    
                                    <!-- 左侧温度传感器连接 -->
                                    <div class="pipe-elbow top-right" style="left: 120px; top: 280px;"></div>
                                    <div class="pipe pipe-horizontal" style="left: 120px; top: 280px; width: 150px;"></div>
                                    <div class="connection-line vertical" style="left: 120px; top: 280px; height: 40px;"></div>
                                    <div class="pipe-joint" style="left: 270px; top: 280px;"></div>
                                    
                                    <!-- 右侧温度传感器连接 -->
                                    <div class="connection-line horizontal" style="right: 120px; top: 280px; width: 100px;"></div>
                                    <div class="connection-line vertical" style="right: 120px; top: 260px; height: 20px;"></div>
                                    <div class="pipe-joint" style="right: 120px; top: 280px;"></div>
                                    
                                    <!-- 底部给水箱系统 -->
                                    <div class="pipe pipe-horizontal pipe-thick" style="left: 180px; bottom: 100px; width: 320px;"></div>
                                    <div class="pipe-arrow pipe-arrow-right" style="left: 380px; bottom: 95px;"></div>
                                    <div class="pump-symbol running" style="left: 300px; bottom: 100px;"></div>
                                    <div class="valve-symbol open" style="left: 420px; bottom: 100px;"></div>
                                    <div class="pipe pipe-vertical" style="left: 500px; bottom: 100px; height: 230px;"></div>
                                    <div class="pipe-joint" style="left: 500px; bottom: 330px;"></div>
                                    
                                    <!-- 氮气加注系统 -->
                                    <div class="pipe pipe-vertical" style="left: 220px; bottom: 100px; height: 80px;"></div>
                                    <div class="pipe-joint" style="left: 220px; bottom: 180px;"></div>
                                    <div class="valve-symbol" style="left: 220px; bottom: 150px;"></div>
                                    <div class="pipe pipe-horizontal" style="left: 140px; bottom: 180px; width: 80px;"></div>
                                    <div class="pipe-arrow pipe-arrow-right" style="left: 180px; bottom: 177px;"></div>
                                    <div class="diagram-label" style="left: 90px; bottom: 190px;">氮气</div>
                                    
                                    <!-- 给水箱 -->
                                    <div class="tank-icon" style="position: absolute; left: 90px; bottom: 120px;"></div>
                                    <div class="diagram-label" style="left: 75px; bottom: 90px;">给水箱</div>
                                    
                                    <!-- 底部排污系统 -->
                                    <div class="pipe pipe-vertical" style="right: 240px; bottom: 40px; height: 330px;"></div>
                                    <div class="pipe-joint" style="right: 240px; bottom: 40px;"></div>
                                    <div class="pipe pipe-horizontal" style="right: 240px; bottom: 40px; width: 120px;"></div>
                                    <div class="valve-symbol closed" style="right: 340px; bottom: 40px;"></div>
                                    <div class="pipe-arrow pipe-arrow-right" style="right: 380px; bottom: 37px;"></div>
                                    <div class="pipe pipe-horizontal" style="right: 420px; bottom: 40px; width: 60px;"></div>
                                    <div class="diagram-label" style="right: 500px; bottom: 50px;">排污阀</div>
                                    
                                    <!-- 底部电导率测量 -->
                                    <div class="connection-line vertical signal" style="left: 350px; bottom: 100px; height: 60px;"></div>
                                    <div class="pipe-joint small" style="left: 350px; bottom: 100px;"></div>
                                    
                                    <!-- 循环泵连接 -->
                                    <div class="connection-line horizontal signal" style="left: 550px; bottom: 150px; width: 100px;"></div>
                                    <div class="pump-symbol running" style="left: 600px; bottom: 150px;"></div>
                                    <div class="diagram-label small" style="left: 620px; bottom: 140px;">循环泵2</div>
                                    
                                    <div class="connection-line horizontal signal" style="left: 550px; bottom: 220px; width: 100px;"></div>
                                    <div class="pump-symbol" style="left: 600px; bottom: 220px;"></div>
                                    <div class="diagram-label small" style="left: 620px; bottom: 210px;">循环泵1</div>
                                    
                                    <!-- 主锅炉容器 -->
                                    <div class="boiler-main">
                                        <div class="boiler-header">
                                            <div class="header-group">
                                                <div class="tag-box">主断路器</div>
                                                <div class="tag-item">
                                                    <span>已连接</span>
                                                    <div class="indicator-circle red"></div>
                                                </div>
                                                <div class="tag-box">OBBA10G S001</div>
                                            </div>
                                            <div class="tag-label">排气阀</div>
                                            <div class="tag-item">
                                                <span>当前闸位</span>
                                                <div class="valve-icon"></div>
                                            </div>
                                        </div>
                                        
                                        <!-- 锅炉压力 -->
                                        <div class="boiler-pressure">
                                            <div class="tag-label">锅炉压力</div>
                                            <div class="tag-box">BE10CP0017</div>
                                            <div class="tag-value">1.1Bar</div>
                                            <div class="tag-text">10千伏</div>
                                        </div>
                                        
                                        <!-- 锅炉主体 -->
                                        <div class="boiler-body">
                                            <div class="boiler-top">
                                                <div class="boiler-power-label">锅炉耗电量</div>
                                                <div class="heating-elements">
                                                    <div class="element">电热<br>L1</div>
                                                    <div class="element">电热<br>L2</div>
                                                    <div class="element">电热<br>L3</div>
                                                </div>
                                                <div class="indicator-circle red large"></div>
                                                <div class="indicator-circle red large"></div>
                                            </div>
                                            
                                            <!-- 水位指示器 -->
                                            <div class="water-level-container">
                                                <div class="water-level" style="height: 84.4%;">
                                                    <div class="water-surface"></div>
                                                </div>
                                                
                                                <!-- 水位标签 -->
                                                <div class="level-tag top">
                                                    <div class="tag-box">BE10CL003</div>
                                                    <div class="tag-value">-0.1%</div>
                                                    <div class="tag-text">锅炉上液位</div>
                                                </div>
                                                <div class="level-tag middle">
                                                    <div class="tag-value">41.6%</div>
                                                    <div class="tag-text">锅炉总水位</div>
                                                </div>
                                                <div class="level-tag bottom">
                                                    <div class="tag-box">BE10CL0017/2</div>
                                                    <div class="tag-value">84.4%</div>
                                                    <div class="tag-text">锅炉下液位</div>
                                                </div>
                                                
                                                <!-- 中间测量点 -->
                                                <div class="measure-point">
                                                    <div class="tag-label small">Bati</div>
                                                    <div class="tag-text small">锅炉功耗控制与限值</div>
                                                    <div class="tag-value green">14.7%</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- 底部排污阀 -->
                                        <div class="boiler-bottom">
                                            <div class="tag-label">排污阀</div>
                                            <div class="valve-icon"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- 左侧温度控制区域 -->
                                    <div class="temp-control-left">
                                        <div class="temp-sensor">
                                            <div class="tag-box">NDB63CT001</div>
                                            <div class="flow-indicator">
                                                <div class="arrow-right"></div>
                                                <div class="flow-label">锅炉三通阀<br>设定值</div>
                                                <div class="flow-percent green">0%</div>
                                            </div>
                                        </div>
                                        
                                        <div class="temp-box">
                                            <div class="tag-label">区域供温度</div>
                                            <div class="tag-box">NDB63CT001/</div>
                                            <div class="tag-value">10.2°C</div>
                                        </div>
                                        
                                        <div class="flow-indicator">
                                            <div class="arrow-left"></div>
                                            <div class="flow-label">锅炉三通阀<br>反馈值</div>
                                            <div class="flow-percent blue">100%</div>
                                        </div>
                                    </div>
                                    
                                    <!-- 右上温度区域 -->
                                    <div class="temp-control-right">
                                        <div class="temp-sensor">
                                            <div class="tag-box">DHG10CT001</div>
                                            <div class="tag-value">11.2°C</div>
                                        </div>
                                        
                                        <div class="temp-box">
                                            <div class="tag-label">锅炉温度</div>
                                            <div class="tag-box">DHG10CT001/2</div>
                                            <div class="tag-value">11°C</div>
                                            <div class="tag-text">锅炉温度环1运行</div>
                                        </div>
                                    </div>
                                    
                                    <!-- 底部参数区域 -->
                                    <div class="bottom-params">
                                        <!-- 氮气系统 -->
                                        <div class="nitrogen-system">
                                            <div class="tag-label">加氢系统行</div>
                                            <div class="valve-icon large"></div>
                                            <div class="tag-label">氮气化物</div>
                                            <div class="tag-box">LAB10AA301</div>
                                            <div class="tank-icon"></div>
                                            <div class="tag-text">给水箱</div>
                                        </div>
                                        
                                        <!-- 功率控制 -->
                                        <div class="power-control">
                                            <div class="tag-box">LFN10AP001</div>
                                            <div class="tag-text">锅炉功耗控制限定值</div>
                                            
                                            <div class="tag-box green">GHG10 CP501</div>
                                            <div class="tag-label">锅炉电导率</div>
                                            
                                            <div class="tag-box green">GHG10 AP001</div>
                                            <div class="tag-value green">0%</div>
                                            <div class="tag-text">15Hz</div>
                                            <div class="tag-label">锅炉循环泵2运行</div>
                                            
                                            <div class="tag-box">GHG10AP002</div>
                                            <div class="tag-value">15%</div>
                                            <div class="tag-text blue">0.1Hz</div>
                                            
                                            <div class="tag-box">GHG10 CQ001</div>
                                            <div class="tag-value">55.5μS</div>
                                        </div>
                                    </div>
                                    
                                    <!-- W2槽充阀 -->
                                    <div class="w2-valve">
                                        <div class="tag-label">W2槽充阀（氮气）</div>
                                        <div class="valve-icon"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 告警记录页签内容 -->
                    <div class="device-tab-content" id="alarmContent" data-device="tianbang-heat-tank">
                        <div class="alarm-container">
                            <!-- 告警统计卡片 -->
                            <div class="alarm-stats">
                                <div class="stat-card critical">
                                    <div class="stat-icon">⚠</div>
                                    <div class="stat-info">
                                        <div class="stat-value">3</div>
                                        <div class="stat-label">严重告警</div>
                                    </div>
                                </div>
                                <div class="stat-card warning">
                                    <div class="stat-icon">⚡</div>
                                    <div class="stat-info">
                                        <div class="stat-value">12</div>
                                        <div class="stat-label">警告</div>
                                    </div>
                                </div>
                                <div class="stat-card info">
                                    <div class="stat-icon">ℹ</div>
                                    <div class="stat-info">
                                        <div class="stat-value">25</div>
                                        <div class="stat-label">提示</div>
                                    </div>
                                </div>
                                <div class="stat-card resolved">
                                    <div class="stat-icon">✓</div>
                                    <div class="stat-info">
                                        <div class="stat-value">156</div>
                                        <div class="stat-label">已处理</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 筛选器 -->
                            <div class="alarm-filters">
                                <div class="filter-group">
                                    <label>告警级别：</label>
                                    <select class="filter-select">
                                        <option value="">全部</option>
                                        <option value="critical">严重</option>
                                        <option value="warning">警告</option>
                                        <option value="info">提示</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>处理状态：</label>
                                    <select class="filter-select">
                                        <option value="">全部</option>
                                        <option value="pending">待处理</option>
                                        <option value="processing">处理中</option>
                                        <option value="resolved">已处理</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>时间范围：</label>
                                    <input type="date" class="filter-input" placeholder="开始时间">
                                    <span style="margin: 0 8px;">至</span>
                                    <input type="date" class="filter-input" placeholder="结束时间">
                                </div>
                                <button class="btn-filter">查询</button>
                                <button class="btn-reset">重置</button>
                            </div>
                            
                            <!-- 告警列表 -->
                            <div class="alarm-table-container">
                                <table class="alarm-table">
                                    <thead>
                                        <tr>
                                            <th width="60">序号</th>
                                            <th width="80">级别</th>
                                            <th width="150">告警时间</th>
                                            <th width="120">设备名称</th>
                                            <th width="150">告警类型</th>
                                            <th>告警内容</th>
                                            <th width="100">当前值</th>
                                            <th width="100">阈值</th>
                                            <th width="100">状态</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="alarm-row critical">
                                            <td>1</td>
                                            <td><span class="alarm-badge critical">严重</span></td>
                                            <td>2025-11-22 14:23:15</td>
                                            <td>电锅炉#1</td>
                                            <td>温度超限</td>
                                            <td>锅炉温度超过安全阈值，存在爆炸风险</td>
                                            <td class="value-danger">125.8°C</td>
                                            <td>≤120°C</td>
                                            <td><span class="status-badge pending">待处理</span></td>
                                        </tr>
                                        <tr class="alarm-row critical">
                                            <td>2</td>
                                            <td><span class="alarm-badge critical">严重</span></td>
                                            <td>2025-11-22 14:18:42</td>
                                            <td>电锅炉#1</td>
                                            <td>压力异常</td>
                                            <td>锅炉内部压力超过最大工作压力</td>
                                            <td class="value-danger">1.8Bar</td>
                                            <td>≤1.6Bar</td>
                                            <td><span class="status-badge processing">处理中</span></td>
                                        </tr>
                                        <tr class="alarm-row warning">
                                            <td>3</td>
                                            <td><span class="alarm-badge warning">警告</span></td>
                                            <td>2025-11-22 14:15:28</td>
                                            <td>循环泵#2</td>
                                            <td>设备异常</td>
                                            <td>循环泵运行电流异常，可能存在堵塞</td>
                                            <td class="value-warning">85A</td>
                                            <td>≤75A</td>
                                            <td><span class="status-badge pending">待处理</span></td>
                                        </tr>
                                        <tr class="alarm-row warning">
                                            <td>4</td>
                                            <td><span class="alarm-badge warning">警告</span></td>
                                            <td>2025-11-22 14:08:53</td>
                                            <td>电锅炉#1</td>
                                            <td>水位偏低</td>
                                            <td>锅炉水位低于正常运行水位</td>
                                            <td class="value-warning">35.2%</td>
                                            <td>≥40%</td>
                                            <td><span class="status-badge resolved">已处理</span></td>
                                        </tr>
                                        <tr class="alarm-row info">
                                            <td>5</td>
                                            <td><span class="alarm-badge info">提示</span></td>
                                            <td>2025-11-22 13:55:17</td>
                                            <td>温度传感器#3</td>
                                            <td>参数波动</td>
                                            <td>回水温度波动较大，建议检查</td>
                                            <td class="value-normal">10.8°C</td>
                                            <td>10±2°C</td>
                                            <td><span class="status-badge resolved">已处理</span></td>
                                        </tr>
                                        <tr class="alarm-row warning">
                                            <td>6</td>
                                            <td><span class="alarm-badge warning">警告</span></td>
                                            <td>2025-11-22 13:42:09</td>
                                            <td>阀门#5</td>
                                            <td>设备故障</td>
                                            <td>排气阀响应时间超时，可能存在卡滞</td>
                                            <td class="value-warning">8.5s</td>
                                            <td>≤5s</td>
                                            <td><span class="status-badge processing">处理中</span></td>
                                        </tr>
                                        <tr class="alarm-row info">
                                            <td>7</td>
                                            <td><span class="alarm-badge info">提示</span></td>
                                            <td>2025-11-22 13:28:34</td>
                                            <td>电锅炉#1</td>
                                            <td>维护提醒</td>
                                            <td>设备已连续运行720小时，建议进行常规维护</td>
                                            <td class="value-normal">720h</td>
                                            <td>≥720h</td>
                                            <td><span class="status-badge pending">待处理</span></td>
                                        </tr>
                                        <tr class="alarm-row critical">
                                            <td>8</td>
                                            <td><span class="alarm-badge critical">严重</span></td>
                                            <td>2025-11-22 13:15:48</td>
                                            <td>电锅炉#1</td>
                                            <td>电气故障</td>
                                            <td>电热元件L2相电流为零，可能断路</td>
                                            <td class="value-danger">0A</td>
                                            <td>≥10A</td>
                                            <td><span class="status-badge resolved">已处理</span></td>
                                        </tr>
                                        <tr class="alarm-row warning">
                                            <td>9</td>
                                            <td><span class="alarm-badge warning">警告</span></td>
                                            <td>2025-11-22 12:58:22</td>
                                            <td>给水箱</td>
                                            <td>液位异常</td>
                                            <td>给水箱液位接近下限，建议补水</td>
                                            <td class="value-warning">18%</td>
                                            <td>≥20%</td>
                                            <td><span class="status-badge resolved">已处理</span></td>
                                        </tr>
                                        <tr class="alarm-row info">
                                            <td>10</td>
                                            <td><span class="alarm-badge info">提示</span></td>
                                            <td>2025-11-22 12:43:56</td>
                                            <td>电锅炉#1</td>
                                            <td>能耗提醒</td>
                                            <td>今日能耗已超过日均值15%</td>
                                            <td class="value-normal">2850kWh</td>
                                            <td>≤2500kWh</td>
                                            <td><span class="status-badge resolved">已处理</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- 分页 -->
                            <div class="alarm-pagination">
                                <div class="pagination-info">
                                    共 196 条记录，当前第 1/20 页
                                </div>
                                <div class="pagination-controls">
                                    <button class="page-btn" disabled>上一页</button>
                                    <button class="page-btn active">1</button>
                                    <button class="page-btn">2</button>
                                    <button class="page-btn">3</button>
                                    <button class="page-btn">4</button>
                                    <button class="page-btn">5</button>
                                    <span class="page-ellipsis">...</span>
                                    <button class="page-btn">20</button>
                                    <button class="page-btn">下一页</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 数据分析页签内容 -->
                    <div class="device-tab-content" id="analysisContent" data-device="tianbang-heat-tank">
                        <div class="analysis-container">
                            <!-- 筛选器 -->
                            <div class="analysis-filters">
                                <div class="filter-group">
                                    <label>参数项：</label>
                                    <select class="filter-select" id="paramType">
                                        <option value="temperature">温度</option>
                                        <option value="pressure">压力</option>
                                        <option value="waterLevel">液位</option>
                                        <option value="current">电流</option>
                                        <option value="voltage">电压</option>
                                        <option value="power">功率</option>
                                        <option value="flow">流量</option>
                                        <option value="frequency">频率</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>开始时间：</label>
                                    <input type="datetime-local" class="filter-input" id="startTime">
                                </div>
                                <div class="filter-group">
                                    <label>结束时间：</label>
                                    <input type="datetime-local" class="filter-input" id="endTime">
                                </div>
                                <button class="btn-filter" id="queryBtn">查询</button>
                                <button class="btn-reset" id="resetBtn">重置</button>
                                <button class="btn-export" id="exportBtn">导出数据</button>
                            </div>
                            
                            <!-- 数据统计卡片 -->
                            <div class="data-stats">
                                <div class="data-stat-card">
                                    <div class="stat-title">当前值</div>
                                    <div class="stat-main-value" id="currentValue">125.8°C</div>
                                    <div class="stat-trend up">↑ 2.5%</div>
                                </div>
                                <div class="data-stat-card">
                                    <div class="stat-title">平均值</div>
                                    <div class="stat-main-value" id="avgValue">118.6°C</div>
                                    <div class="stat-trend">持平</div>
                                </div>
                                <div class="data-stat-card">
                                    <div class="stat-title">最大值</div>
                                    <div class="stat-main-value" id="maxValue">128.4°C</div>
                                    <div class="stat-trend down">↓ 1.2%</div>
                                </div>
                                <div class="data-stat-card">
                                    <div class="stat-title">最小值</div>
                                    <div class="stat-main-value" id="minValue">108.2°C</div>
                                    <div class="stat-trend up">↑ 3.8%</div>
                                </div>
                            </div>
                            
                            <!-- 图表容器 -->
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">温度趋势分析</h3>
                                    <div class="chart-legend">
                                        <div class="legend-item">
                                            <span class="legend-color" style="background: #1890ff;"></span>
                                            <span>实时值</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color" style="background: #ff4d4f;"></span>
                                            <span>上限值</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color" style="background: #faad14;"></span>
                                            <span>下限值</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color" style="background: #52c41a;"></span>
                                            <span>均值</span>
                                        </div>
                                    </div>
                                </div>
                                <div id="dataChart" style="width: 100%; height: 450px;"></div>
                            </div>
                            
                            <!-- 实时数据表格 -->
                            <div class="data-table-section">
                                <div class="section-header">
                                    <h3>实时数据表</h3>
                                </div>
                                <div class="data-table-wrapper">
                                    <table class="data-history-table">
                                        <thead>
                                            <tr>
                                                <th>时间</th>
                                                <th>实时值</th>
                                                <th>上限值</th>
                                                <th>下限值</th>
                                                <th>均值</th>
                                                <th>状态</th>
                                            </tr>
                                        </thead>
                                        <tbody id="dataTableBody">
                                            <!-- 动态填充 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

<script>
        // 多个CDN源备选
        var echartsUrls = [
            'https://registry.npmmirror.com/echarts/5.4.3/files/dist/echarts.min.js',
            'https://unpkg.com/echarts@5.4.3/dist/echarts.min.js',
            'https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js',
            'https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js'
        ];
        
        var currentUrlIndex = 0;
        
        function loadECharts() {
            if (currentUrlIndex >= echartsUrls.length) {
                console.error('所有ECharts CDN源都加载失败');
                return;
            }
            
            var script = document.createElement('script');
            script.src = echartsUrls[currentUrlIndex];
            
            script.onload = function() {
                console.log('✓ ECharts加载成功:', echartsUrls[currentUrlIndex]);
                loadMainScript();
            };
            
            script.onerror = function() {
                console.warn('✗ ECharts加载失败:', echartsUrls[currentUrlIndex]);
                currentUrlIndex++;
                loadECharts();
            };
            
            document.head.appendChild(script);
        }
        
        function loadMainScript() {
            var script = document.createElement('script');
            script.src = 'script.js';
            document.body.appendChild(script);
        }
        
        // 开始加载
        loadECharts();
    </script>

<script>
        // 设备检测页面专用脚本
        (function() {
            // 页签切换
            const deviceTabs = document.querySelectorAll('.device-tab');
            const tabContents = document.querySelectorAll('.device-tab-content');
            
            deviceTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');
                    
                    // 移除所有激活状态
                    deviceTabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // 激活当前页签
                    this.classList.add('active');
                    document.getElementById(targetTab + 'Content').classList.add('active');
                    
                    // 如果切换到数据分析页签，初始化图表
                    if (targetTab === 'analysis') {
                        setTimeout(() => {
                            // 检查ECharts是否已加载
                            if (typeof echarts === 'undefined') {
                                console.warn('ECharts未加载，等待加载...');
                                const checkECharts = setInterval(() => {
                                    if (typeof echarts !== 'undefined') {
                                        clearInterval(checkECharts);
                                        initAnalysisChart();
                                    }
                                }, 100);
                                // 10秒后停止检查
                                setTimeout(() => clearInterval(checkECharts), 10000);
                            } else {
                                initAnalysisChart();
                            }
                        }, 300);
                    }

                    // 能耗统计页签
                    if (targetTab === 'energy') {
                        setTimeout(() => {
                            if (typeof echarts === 'undefined') {
                                const checkEnergyChart = setInterval(() => {
                                    if (typeof echarts !== 'undefined') {
                                        clearInterval(checkEnergyChart);
                                        initEnergyChart();
                                    }
                                }, 100);
                                setTimeout(() => clearInterval(checkEnergyChart), 10000);
                            } else {
                                initEnergyChart();
                            }
                        }, 300);
                    }
                });
            });
            
            // 初始化数据分析图表的函数
            function initAnalysisChart() {
                console.log('开始初始化数据分析图表...');
                
                // 检查图表容器是否存在
                const chartElement = document.getElementById('dataChart');
                if (!chartElement) {
                    console.error('图表容器未找到！');
                    return;
                }
                
                // 初始化图表（如果还未初始化）
                if (typeof window.dataChart === 'undefined' || !window.dataChart) {
                    try {
                        window.dataChart = echarts.init(chartElement);
                        window.chartInitialized = true;
                        console.log('✓ 图表初始化成功');
                    } catch(error) {
                        console.error('图表初始化失败:', error);
                        return;
                    }
                }
                
                // 设置默认时间
                const startTimeInput = document.getElementById('startTime');
                const endTimeInput = document.getElementById('endTime');
                const paramTypeSelect = document.getElementById('paramType');
                
                if (startTimeInput && endTimeInput && paramTypeSelect) {
                    const end = new Date();
                    const start = new Date(end.getTime() - 24 * 60 * 60 * 1000);
                    
                    const formatDateTime = (date) => {
                        const year = date.getFullYear();
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        const day = String(date.getDate()).padStart(2, '0');
                        const hours = String(date.getHours()).padStart(2, '0');
                        const minutes = String(date.getMinutes()).padStart(2, '0');
                        return `${year}-${month}-${day}T${hours}:${minutes}`;
                    };
                    
                    if (!startTimeInput.value) {
                        startTimeInput.value = formatDateTime(start);
                    }
                    if (!endTimeInput.value) {
                        endTimeInput.value = formatDateTime(end);
                    }
                    
                    // 触发查询（调用script.js中的函数）
                    if (typeof window.renderChart === 'function' && 
                        typeof window.updateStats === 'function' && 
                        typeof window.fillTableData === 'function') {
                        const paramType = paramTypeSelect.value || 'temperature';
                        const startTime = startTimeInput.value;
                        const endTime = endTimeInput.value;
                        
                        if (startTime && endTime) {
                            window.renderChart(paramType, startTime, endTime);
                            window.updateStats(paramType);
                            window.fillTableData(paramType, startTime, endTime);
                        }
                    } else {
                        console.warn('图表渲染函数未加载，等待script.js加载...');
                        // 等待script.js加载
                        setTimeout(() => {
                            if (typeof window.renderChart === 'function') {
                                const paramType = paramTypeSelect.value || 'temperature';
                                const startTime = startTimeInput.value;
                                const endTime = endTimeInput.value;
                                if (startTime && endTime) {
                                    window.renderChart(paramType, startTime, endTime);
                                    window.updateStats(paramType);
                                    window.fillTableData(paramType, startTime, endTime);
                                }
                            }
                        }, 500);
                    }
                }
            }

            function initEnergyChart() {
                console.log('开始初始化能耗趋势图表...');
                const chartElement = document.getElementById('energyChart');
                if (!chartElement) {
                    console.error('能耗图表容器未找到！');
                    return;
                }

                if (typeof window.energyChart === 'undefined' || !window.energyChart) {
                    try {
                        window.energyChart = echarts.init(chartElement);
                        console.log('✓ 能耗图表初始化成功');
                    } catch (error) {
                        console.error('能耗图表初始化失败:', error);
                        return;
                    }
                }

                const hours = ['00:00','02:00','04:00','06:00','08:00','10:00','12:00','14:00','16:00','18:00','20:00','22:00'];
                const energyUsage = [48, 42, 39, 45, 62, 74, 88, 96, 110, 142, 128, 98];
                const energyCost = [0.9,0.8,0.75,0.78,0.94,1.05,1.12,1.18,1.32,1.48,1.35,1.05];

                const option = {
                    tooltip: {
                        trigger: 'axis',
                        formatter: params => {
                            const usage = params[0];
                            const cost = params[1];
                            return `${usage.axisValue}<br/>能耗: ${usage.data} kWh<br/>能耗单价: ${cost.data.toFixed(2)} 元/kWh`;
                        }
                    },
                    legend: {
                        data: ['能耗', '能耗单价'],
                        bottom: 10
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '18%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: hours
                    },
                    yAxis: [
                        {
                            type: 'value',
                            name: '能耗 (kWh)',
                            position: 'left',
                            min: 0,
                            max: 160,
                            axisLine: { lineStyle: { color: '#1890ff' } },
                            axisLabel: { formatter: '{value}' }
                        },
                        {
                            type: 'value',
                            name: '能耗单价 (元/kWh)',
                            position: 'right',
                            axisLine: { lineStyle: { color: '#faad14' } },
                            axisLabel: { formatter: '{value}' }
                        }
                    ],
                    series: [
                        {
                            name: '能耗',
                            type: 'line',
                            smooth: true,
                            areaStyle: {
                                color: 'rgba(24, 144, 255, 0.22)'
                            },
                            symbol: 'circle',
                            symbolSize: 6,
                            lineStyle: {
                                width: 2
                            },
                            data: energyUsage
                        },
                        {
                            name: '能耗单价',
                            type: 'line',
                            yAxisIndex: 1,
                            smooth: true,
                            symbol: 'diamond',
                            itemStyle: {
                                color: '#faad14'
                            },
                            lineStyle: {
                                width: 2,
                                type: 'dashed'
                            },
                            data: energyCost
                        }
                    ]
                };

                window.energyChart.setOption(option);

                window.addEventListener('resize', () => {
                    if (window.energyChart) {
                        window.energyChart.resize();
                    }
                });
            }
            
            // 如果页面加载时就在数据分析页签，也初始化
            setTimeout(() => {
                const analysisTab = document.querySelector('.device-tab[data-tab="analysis"]');
                if (analysisTab && analysisTab.classList.contains('active')) {
                    console.log('页面加载时在数据分析页签，初始化图表');
                    if (typeof echarts !== 'undefined') {
                        initAnalysisChart();
                    } else {
                        const checkECharts = setInterval(() => {
                            if (typeof echarts !== 'undefined') {
                                clearInterval(checkECharts);
                                initAnalysisChart();
                            }
                        }, 100);
                        setTimeout(() => clearInterval(checkECharts), 10000);
                    }
                }
            }, 1000);
            
            // 项目展开/收起
            const projectHeaders = document.querySelectorAll('.device-project-header');
            projectHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const projectItem = this.closest('.device-project-item');
                    const toggle = this.querySelector('.device-project-toggle');
                    const children = projectItem.querySelector('.device-project-children');
                    
                    if (projectItem.classList.contains('expanded')) {
                        projectItem.classList.remove('expanded');
                        toggle.textContent = '▶';
                        if (children) {
                            children.style.display = 'none';
                        }
                    } else {
                        projectItem.classList.add('expanded');
                        toggle.textContent = '▼';
                        if (children) {
                            children.style.display = 'block';
                        }
                    }
                });
            });
            
            // 设备项点击 - 切换右侧页签数据
            const deviceItems = document.querySelectorAll('.device-device-item');
            deviceItems.forEach(item => {
                item.addEventListener('click', function() {
                    deviceItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 更新标题
                    const projectName = this.closest('.device-project-item').querySelector('.device-project-name').textContent;
                    const deviceName = this.getAttribute('data-device-name') || this.textContent;
                    document.getElementById('deviceTitle').textContent = projectName + '——' + deviceName;
                    
                    // 获取设备ID
                    const deviceId = this.getAttribute('data-device-id');
                    
                    // 切换所有页签内容的数据
                    const tabContents = document.querySelectorAll('.device-tab-content');
                    tabContents.forEach(content => {
                        content.setAttribute('data-device', deviceId);
                        // 这里可以根据设备ID加载不同的数据
                        loadDeviceData(deviceId, content.id);
                    });
                });
            });
            
            // 加载设备数据的函数
            function loadDeviceData(deviceId, contentId) {
                // 根据设备ID和内容ID加载对应的数据
                console.log('加载设备数据:', deviceId, contentId);
                
                // 如果是实时监测页签，更新监测数据
                if (contentId === 'monitoringContent') {
                    updateMonitoringData(deviceId);
                }
            }
            
            // 更新实时监测数据
            function updateMonitoringData(deviceId) {
                // 这里可以根据不同设备显示不同的监测数据
                const monitoringGrid = document.querySelector('#monitoringContent .monitoring-grid');
                if (!monitoringGrid) return;
            }
            
            // 参数阈值定义（正常范围）
            const parameterThresholds = {
                '电流1': { min: 0, max: 150, warning: 130, danger: 145 },
                '电流2': { min: 0, max: 150, warning: 130, danger: 145 },
                '电流3': { min: 0, max: 150, warning: 130, danger: 145 },
                '电压1': { min: 350, max: 400, warning: 360, danger: 350 },
                '电压2': { min: 350, max: 400, warning: 360, danger: 350 },
                '电压3': { min: 350, max: 400, warning: 360, danger: 350 },
                '功率1': { min: 0, max: 50, warning: 45, danger: 48 },
                '功率2': { min: 0, max: 50, warning: 45, danger: 48 },
                '功率3': { min: 0, max: 50, warning: 45, danger: 48 },
                '总功率': { min: 0, max: 150, warning: 135, danger: 144 },
                '锅炉温度': { min: 0, max: 100, warning: 90, danger: 95 },
                '出水温度': { min: 0, max: 90, warning: 85, danger: 88 },
                '回水温度': { min: 0, max: 80, warning: 75, danger: 78 },
                '锅炉压力': { min: 0, max: 1.0, warning: 0.8, danger: 0.9 },
                '系统压力': { min: 0, max: 0.8, warning: 0.7, danger: 0.75 },
                '水位': { min: 20, max: 100, warning: 30, danger: 25 },
                '流量': { min: 0, max: 200, warning: 180, danger: 190 },
                '频率1': { min: 48, max: 52, warning: 49, danger: 48 },
                '频率2': { min: 48, max: 52, warning: 49, danger: 48 },
                '频率3': { min: 48, max: 52, warning: 49, danger: 48 },
                '效率': { min: 80, max: 100, warning: 85, danger: 82 },
                'PH值': { min: 6.5, max: 8.5, warning: 7.0, danger: 6.8 },
                '电导率': { min: 0, max: 2000, warning: 1800, danger: 1900 },
                '溶解氧': { min: 5, max: 12, warning: 6, danger: 5.5 },
                '烟温': { min: 0, max: 250, warning: 220, danger: 240 },
                '排烟温度': { min: 0, max: 200, warning: 180, danger: 190 },
                '进风温度': { min: -10, max: 40, warning: 35, danger: 38 },
                '出风温度': { min: 0, max: 100, warning: 90, danger: 95 },
                '蒸汽压力': { min: 0, max: 1.2, warning: 1.0, danger: 1.1 },
                '蒸汽温度': { min: 0, max: 150, warning: 130, danger: 140 }
            };
            
            // 检查参数是否超标并应用样式
            function checkParameterStatus(label, value) {
                const threshold = parameterThresholds[label];
                if (!threshold) return 'normal';
                
                const numValue = parseFloat(value);
                if (isNaN(numValue)) return 'normal';
                
                // 检查是否超出危险值（红色）
                if (threshold.danger !== undefined) {
                    if (threshold.max !== undefined && numValue >= threshold.danger) {
                        return 'danger';
                    }
                    if (threshold.min !== undefined && numValue <= threshold.danger) {
                        return 'danger';
                    }
                }
                
                // 检查是否超出警告值（黄色）
                if (threshold.warning !== undefined) {
                    if (threshold.max !== undefined && numValue >= threshold.warning) {
                        return 'warning';
                    }
                    if (threshold.min !== undefined && numValue <= threshold.warning) {
                        return 'warning';
                    }
                }
                
                // 检查是否超出正常范围
                if (threshold.max !== undefined && numValue > threshold.max) {
                    return numValue >= threshold.max * 1.1 ? 'danger' : 'warning';
                }
                if (threshold.min !== undefined && numValue < threshold.min) {
                    return numValue <= threshold.min * 0.9 ? 'danger' : 'warning';
                }
                
                return 'normal';
            }
            
            // 更新参数状态样式
            function updateParameterStatus(item, label, value) {
                const status = checkParameterStatus(label, value);
                item.classList.remove('parameter-normal', 'parameter-warning', 'parameter-danger');
                item.classList.add('parameter-' + status);
            }
            
            // 模拟参数实时变化
            function simulateRealTimeData() {
                const monitoringItems = document.querySelectorAll('#monitoringContent .monitoring-item');
                
                monitoringItems.forEach(item => {
                    const label = item.querySelector('.monitoring-label').textContent.replace(':', '');
                    const input = item.querySelector('.monitoring-input');
                    const currentValue = parseFloat(input.value) || 0;
                    const threshold = parameterThresholds[label];
                    
                    if (!threshold) return;
                    
                    // 生成随机变化（在正常范围内波动）
                    let newValue;
                    if (threshold.min !== undefined && threshold.max !== undefined) {
                        const range = threshold.max - threshold.min;
                        const variation = range * 0.05; // 5%的波动
                        newValue = currentValue + (Math.random() - 0.5) * variation * 2;
                        
                        // 偶尔生成超标值（15%概率）
                        if (Math.random() < 0.15) {
                            if (Math.random() < 0.5) {
                                // 超出上限
                                newValue = threshold.max + Math.random() * (threshold.max * 0.2);
                            } else {
                                // 低于下限
                                newValue = Math.max(0, threshold.min - Math.random() * (threshold.min * 0.2));
                            }
                        }
                        
                        // 限制在合理范围内
                        newValue = Math.max(threshold.min * 0.5, Math.min(threshold.max * 1.5, newValue));
                    } else {
                        // 对于没有明确范围的参数，小幅波动
                        newValue = currentValue * (0.98 + Math.random() * 0.04);
                    }
                    
                    // 格式化数值
                    if (label.includes('温度') || label.includes('压力') || label.includes('PH值') || label.includes('效率')) {
                        newValue = newValue.toFixed(1);
                    } else if (label.includes('时间') || label.includes('运行') || label.includes('统计')) {
                        newValue = Math.round(newValue);
                    } else {
                        newValue = Math.round(newValue * 10) / 10;
                    }
                    
                    input.value = newValue;
                    updateParameterStatus(item, label, newValue);
                });
            }
            
            // 启动实时数据更新（每2秒更新一次）
            let realTimeInterval = null;
            
            function startRealTimeMonitoring() {
                if (realTimeInterval) {
                    clearInterval(realTimeInterval);
                }
                realTimeInterval = setInterval(simulateRealTimeData, 2000);
            }
            
            function stopRealTimeMonitoring() {
                if (realTimeInterval) {
                    clearInterval(realTimeInterval);
                    realTimeInterval = null;
                }
            }
            
            // 初始化实时监测
            const monitoringContent = document.getElementById('monitoringContent');
            if (monitoringContent) {
                // 初始化所有参数状态
                const monitoringItems = document.querySelectorAll('#monitoringContent .monitoring-item');
                monitoringItems.forEach(item => {
                    const label = item.querySelector('.monitoring-label').textContent.replace(':', '');
                    const input = item.querySelector('.monitoring-input');
                    updateParameterStatus(item, label, input.value);
                });
                
                // 启动实时更新
                startRealTimeMonitoring();
                
                // 当切换到其他页签时停止更新
                deviceTabs.forEach(tab => {
                    tab.addEventListener('click', function() {
                        const targetTab = this.getAttribute('data-tab');
                        if (targetTab === 'monitoring') {
                            startRealTimeMonitoring();
                        } else {
                            stopRealTimeMonitoring();
                        }
                    });
                });
            }
        })();
    </script>