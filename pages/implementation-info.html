<!-- æ ‡ç­¾é¡µ -->
            <div class="tabs">
                <div class="tab active">
        å®æ–½ä¿¡æ¯ <span class="tab-badge">å®æ–½éƒ¨</span>
                    <span class="tab-close">Ã—</span>
                </div>
</div>

<!-- å®æ–½éƒ¨å·¥ä½œå° -->
<div class="implementation-info-wrapper">
    <div class="dept-header">
        <h2 class="dept-title">âš™ï¸ å®æ–½éƒ¨å·¥ä½œå°</h2>
        <p class="dept-desc">ç®¡ç†å®æ–½ä»»åŠ¡ã€è·Ÿè¸ªæ–½å·¥è¿›åº¦ã€éªŒæ”¶ç™»è®°</p>
            </div>

            <!-- æœç´¢ç­›é€‰åŒºåŸŸ -->
            <div class="search-section">
                <div class="search-filters">
            <div class="filter-item">
                <label>é¡¹ç›®ç¼–å·</label>
                <input type="text" placeholder="è¾“å…¥é¡¹ç›®ç¼–å·" class="filter-input" id="filterProjectNumber">
            </div>
                    <div class="filter-item">
                        <label>é¡¹ç›®åç§°</label>
                <input type="text" placeholder="è¾“å…¥é¡¹ç›®åç§°" class="filter-input" id="filterProjectName">
            </div>
            <div class="filter-item">
                <label>å®æ–½è´Ÿè´£äºº</label>
                <select class="filter-input" id="filterImplManager">
                    <option value="">å…¨éƒ¨</option>
                    <option value="å¼ ä¸‰">å¼ ä¸‰</option>
                    <option value="æå››">æå››</option>
                    <option value="ç‹äº”">ç‹äº”</option>
                    <option value="èµµå…­">èµµå…­</option>
                </select>
                    </div>
                    <div class="filter-item">
                <label>å®æ–½çŠ¶æ€</label>
                <select class="filter-input" id="filterStatus">
                    <option value="">å…¨éƒ¨</option>
                    <option value="å¾…å¼€å·¥">å¾…å¼€å·¥</option>
                    <option value="å®æ–½ä¸­">å®æ–½ä¸­</option>
                    <option value="å·²å®Œå·¥">å·²å®Œå·¥</option>
                    <option value="å·²éªŒæ”¶">å·²éªŒæ”¶</option>
                </select>
                    </div>
                </div>
                <div class="search-actions">
            <button class="btn-query" onclick="queryImplementations()">QæŸ¥è¯¢</button>
            <button class="btn-reset" onclick="resetFilters()">Cé‡ç½®</button>
            <button class="btn-expand" onclick="toggleFilters()">å±•å¼€</button>
        </div>
    </div>

    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <div class="stats-cards">
        <div class="stat-card stat-card-waiting">
            <div class="stat-icon">â°</div>
            <div class="stat-content">
                <div class="stat-value">8</div>
                <div class="stat-label">å¾…å¼€å·¥</div>
            </div>
        </div>
        <div class="stat-card stat-card-working">
            <div class="stat-icon">ğŸ”§</div>
            <div class="stat-content">
                <div class="stat-value">25</div>
                <div class="stat-label">å®æ–½ä¸­</div>
            </div>
        </div>
        <div class="stat-card stat-card-finished">
            <div class="stat-icon">âœ”ï¸</div>
            <div class="stat-content">
                <div class="stat-value">6</div>
                <div class="stat-label">å¾…éªŒæ”¶</div>
            </div>
                </div>
        <div class="stat-card stat-card-accepted">
            <div class="stat-icon">ğŸ‰</div>
            <div class="stat-content">
                <div class="stat-value">48</div>
                <div class="stat-label">å·²éªŒæ”¶</div>
            </div>
        </div>
    </div>

    <!-- æ“ä½œæŒ‰é’® -->
    <div class="table-actions">
        <button class="btn-export" onclick="exportImplementations()">å¯¼å‡º</button>
        <button class="btn-refresh" onclick="refreshData()">åˆ·æ–°</button>
            </div>

            <!-- æ•°æ®è¡¨æ ¼ -->
            <div class="table-container">
        <table class="data-table implementation-list-table" id="implementationTable">
                    <thead>
                        <tr>
                            <th>åºå·</th>
                            <th>é¡¹ç›®ç¼–å·</th>
                            <th>é¡¹ç›®åç§°</th>
                            <th>å®¢æˆ·åç§°</th>
                    <th>é¡¹ç›®è´Ÿè´£äºº</th>
                    <th>å®æ–½è´Ÿè´£äºº</th>
                    <th>è®¡åˆ’å¼€å§‹</th>
                    <th>å®é™…å¼€å§‹</th>
                    <th>è®¡åˆ’å®Œå·¥</th>
                    <th>å®é™…å®Œå·¥</th>
                    <th>å®æ–½è¿›åº¦</th>
                    <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                <!-- å¾…å¼€å·¥ - é¡¹ç›®éƒ¨åˆšåˆ†é…è¿‡æ¥çš„ -->
                <tr data-id="1" data-status="å¾…å¼€å·¥">
                            <td>1</td>
                    <td>PE2025-11-2001</td>
                    <td>æ­£å¤§åŒ–å·¥å›­åŒºé…ç”µæ”¹é€ é¡¹ç›®</td>
                    <td>æ­£å¤§åŒ–å·¥æœ‰é™å…¬å¸</td>
                    <td>ç‹æ˜</td>
                    <td>å¼ ä¸‰</td>
                    <td>2025-12-01</td>
                    <td><span class="text-muted">æœªå¼€å·¥</span></td>
                    <td>2026-05-31</td>
                    <td>-</td>
                    <td><div class="progress-bar-mini" style="width:0%"><span>0%</span></div></td>
                    <td><span class="status-badge status-warning">å¾…å¼€å·¥</span></td>
                            <td class="actions">
                        <a href="#" class="action-link action-primary" onclick="startImplementation(1); return false;">å¼€å·¥ç™»è®°</a>
                        <a href="#" class="action-link" onclick="viewProjectInfo(1); return false;">é¡¹ç›®ä¿¡æ¯</a>
                            </td>
                        </tr>
                
                <!-- å®æ–½ä¸­ -->
                <tr data-id="2" data-status="å®æ–½ä¸­">
                            <td>2</td>
                    <td>PE2025-10-1501</td>
                    <td>æ–°ç–†æ˜Œå‰é£ç”µåœºå¹¶ç½‘é¡¹ç›®</td>
                    <td>æ–°ç–†æ˜Œå‰æ–°èƒ½æºæœ‰é™å…¬å¸</td>
                    <td>èµµå¼º</td>
                    <td>å¼ ä¸‰</td>
                    <td>2025-11-01</td>
                    <td>2025-11-05</td>
                            <td>2026-06-30</td>
                    <td>-</td>
                    <td><div class="progress-bar-mini" style="width:35%"><span>35%</span></div></td>
                    <td><span class="status-badge status-implementation">å®æ–½ä¸­</span></td>
                            <td class="actions">
                        <a href="#" class="action-link" onclick="updateProgress(2); return false;">æ›´æ–°è¿›åº¦</a>
                        <a href="#" class="action-link" onclick="viewProgressDetail(2); return false;">è¿›åº¦è¯¦æƒ…</a>
                        <a href="#" class="action-link" onclick="completeImplementation(2); return false;">å®Œå·¥ç™»è®°</a>
                            </td>
                        </tr>
                
                <tr data-id="3" data-status="å®æ–½ä¸­">
                            <td>3</td>
                    <td>PE2025-10-0801</td>
                    <td>æ­¦æ±‰è¿ˆç‘åŒ»ç–—è®¾å¤‡ä¾›ç”µé¡¹ç›®</td>
                    <td>æ­¦æ±‰è¿ˆç‘åŒ»ç–—è®¾å¤‡æœ‰é™å…¬å¸</td>
                    <td>åˆ˜é™</td>
                    <td>æå››</td>
                    <td>2025-11-15</td>
                    <td>2025-11-18</td>
                    <td>2026-03-31</td>
                    <td>-</td>
                    <td><div class="progress-bar-mini" style="width:20%"><span>20%</span></div></td>
                    <td><span class="status-badge status-implementation">å®æ–½ä¸­</span></td>
                    <td class="actions">
                        <a href="#" class="action-link" onclick="updateProgress(3); return false;">æ›´æ–°è¿›åº¦</a>
                        <a href="#" class="action-link" onclick="viewProgressDetail(3); return false;">è¿›åº¦è¯¦æƒ…</a>
                        <a href="#" class="action-link" onclick="completeImplementation(3); return false;">å®Œå·¥ç™»è®°</a>
                    </td>
                </tr>
                
                <tr data-id="4" data-status="å®æ–½ä¸­">
                    <td>4</td>
                    <td>PE2025-09-1801</td>
                    <td>æ´›é˜³çŸ³åŒ–é…ç”µæ™ºèƒ½åŒ–æ”¹é€ </td>
                    <td>æ´›é˜³çŸ³åŒ–é›†å›¢</td>
                    <td>å­™ä¼Ÿ</td>
                    <td>ç‹äº”</td>
                    <td>2025-10-10</td>
                    <td>2025-10-12</td>
                    <td>2026-02-28</td>
                    <td>-</td>
                    <td><div class="progress-bar-mini" style="width:75%"><span>75%</span></div></td>
                    <td><span class="status-badge status-implementation">å®æ–½ä¸­</span></td>
                    <td class="actions">
                        <a href="#" class="action-link" onclick="updateProgress(4); return false;">æ›´æ–°è¿›åº¦</a>
                        <a href="#" class="action-link" onclick="viewProgressDetail(4); return false;">è¿›åº¦è¯¦æƒ…</a>
                        <a href="#" class="action-link action-success" onclick="completeImplementation(4); return false;">å®Œå·¥ç™»è®°</a>
                    </td>
                </tr>
                
                <!-- å·²å®Œå·¥å¾…éªŒæ”¶ -->
                <tr data-id="5" data-status="å·²å®Œå·¥">
                    <td>5</td>
                    <td>PE2025-09-2501</td>
                    <td>å¹³é¡¶å±±å°¼é¾™äº§ä¸šå›­é…ç”µå·¥ç¨‹</td>
                    <td>å¹³é¡¶å±±å°¼é¾™äº§ä¸šå›­ç®¡ç†æœ‰é™å…¬å¸</td>
                    <td>å­™ä¼Ÿ</td>
                    <td>èµµå…­</td>
                    <td>2025-10-20</td>
                    <td>2025-10-22</td>
                    <td>2026-04-30</td>
                    <td>2026-04-25</td>
                    <td><div class="progress-bar-mini complete" style="width:100%"><span>100%</span></div></td>
                    <td><span class="status-badge status-complete">å·²å®Œå·¥</span></td>
                    <td class="actions">
                        <a href="#" class="action-link" onclick="viewProgressDetail(5); return false;">è¿›åº¦è¯¦æƒ…</a>
                        <a href="#" class="action-link action-success" onclick="registerAcceptance(5); return false;">éªŒæ”¶ç™»è®°</a>
                    </td>
                </tr>
                
                <!-- å·²éªŒæ”¶ -->
                <tr data-id="6" data-status="å·²éªŒæ”¶">
                    <td>6</td>
                    <td>PE2025-08-0601</td>
                    <td>å¼€å°åˆ¶è¯å‚ä¾›ç”µç³»ç»Ÿå‡çº§</td>
                    <td>å¼€å°åˆ¶è¯è‚¡ä»½æœ‰é™å…¬å¸</td>
                    <td>åˆ˜é™</td>
                    <td>å¼ ä¸‰</td>
                    <td>2025-09-01</td>
                    <td>2025-09-03</td>
                    <td>2026-01-31</td>
                    <td>2026-01-28</td>
                    <td><div class="progress-bar-mini complete" style="width:100%"><span>100%</span></div></td>
                    <td><span class="status-badge status-acceptance">å·²éªŒæ”¶</span></td>
                            <td class="actions">
                        <a href="#" class="action-link" onclick="viewProjectArchive(6); return false;">é¡¹ç›®æ¡£æ¡ˆ</a>
                        <a href="#" class="action-link" onclick="downloadAcceptanceReport(6); return false;">éªŒæ”¶æŠ¥å‘Š</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- åˆ†é¡µ -->
            <div class="pagination">
                <div class="pagination-info">
            <span>å…±87ä¸ªå®æ–½ä»»åŠ¡</span>
                </div>
                <div class="pagination-controls">
                    <select class="page-size">
                        <option value="20" selected>20æ¡/é¡µ</option>
                        <option value="50">50æ¡/é¡µ</option>
                        <option value="100">100æ¡/é¡µ</option>
                    </select>
                    <div class="page-nav">
                        <button class="page-btn" disabled><</button>
                        <button class="page-btn active">1</button>
                <button class="page-btn">2</button>
                <button class="page-btn">3</button>
                <button class="page-btn">4</button>
                <button class="page-btn">5</button>
                        <button class="page-btn">></button>
                    </div>
                    <div class="page-jump">
                        <span>å‰å¾€</span>
                        <input type="number" class="page-input" value="1" min="1">
                        <span>é¡µ</span>
            </div>
                    </div>
                </div>
            </div>

<!-- å¼€å·¥ç™»è®°å¼¹çª— -->
<div class="modal-overlay" id="startImplModal" style="display:none;">
    <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
            <h3 class="modal-title">ğŸš€ é¡¹ç›®å¼€å·¥ç™»è®°</h3>
            <button class="modal-close" type="button">Ã—</button>
            </div>
            <div class="modal-body">
            <form id="startImplForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>é¡¹ç›®ç¼–å·</label>
                        <input type="text" class="modal-input" id="startProjectNumber" readonly style="background-color:#f5f5f5;">
                        </div>
                        <div class="form-group">
                            <label>é¡¹ç›®åç§°</label>
                        <input type="text" class="modal-input" id="startProjectName" readonly style="background-color:#f5f5f5;">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å®é™…å¼€å·¥æ—¶é—´<span class="required">*</span></label>
                        <input type="date" class="modal-input" id="actualStartDate" required>
                    </div>
                    <div class="form-group">
                        <label>æ–½å·¥é˜Ÿäººæ•°</label>
                        <input type="number" class="modal-input" id="constructionTeamSize" min="1" placeholder="å¦‚ï¼š8">
                    </div>
                    <div class="form-group">
                        <label>ç°åœºè´Ÿè´£äºº</label>
                        <input type="text" class="modal-input" id="siteManager" placeholder="ç°åœºè´Ÿè´£äººå§“å">
                    </div>
                        </div>
                <div class="form-row">
                    <div class="form-group full-width">
                        <label>å¼€å·¥è¯´æ˜</label>
                        <textarea class="modal-input" id="startRemark" rows="2" placeholder="è¯·è¾“å…¥å¼€å·¥ç›¸å…³è¯´æ˜ã€å‡†å¤‡æƒ…å†µç­‰"></textarea>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="modal-btn modal-btn-cancel">å–æ¶ˆ</button>
            <button type="button" class="modal-btn modal-btn-confirm">ç¡®è®¤å¼€å·¥</button>
        </div>
    </div>
</div>

<!-- æ›´æ–°è¿›åº¦å¼¹çª— -->
<div class="modal-overlay" id="updateProgressModal" style="display:none;">
    <div class="modal-content" style="max-width: 800px;">
        <div class="modal-header">
            <h3 class="modal-title">ğŸ“Š æ›´æ–°å®æ–½è¿›åº¦</h3>
            <button class="modal-close" type="button">Ã—</button>
        </div>
        <div class="modal-body">
            <form id="updateProgressForm">
                    <div class="form-row">
                        <div class="form-group">
                        <label>é¡¹ç›®ç¼–å·</label>
                        <input type="text" class="modal-input" id="progressProjectNumber" readonly style="background-color:#f5f5f5;">
                        </div>
                        <div class="form-group">
                        <label>é¡¹ç›®åç§°</label>
                        <input type="text" class="modal-input" id="progressProjectName" readonly style="background-color:#f5f5f5;">
                    </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                        <label>å½“å‰è¿›åº¦ï¼ˆ%ï¼‰<span class="required">*</span></label>
                        <input type="number" class="modal-input" id="progressPercent" min="0" max="100" required>
                        </div>
                        <div class="form-group">
                        <label>å®æ–½é˜¶æ®µ</label>
                        <select class="modal-input" id="implPhase">
                                <option value="">è¯·é€‰æ‹©</option>
                            <option value="åŸºç¡€æ–½å·¥">åŸºç¡€æ–½å·¥</option>
                            <option value="è®¾å¤‡å®‰è£…">è®¾å¤‡å®‰è£…</option>
                            <option value="ç³»ç»Ÿè°ƒè¯•">ç³»ç»Ÿè°ƒè¯•</option>
                            <option value="è¯•è¿è¡Œ">è¯•è¿è¡Œ</option>
                            <option value="æ”¶å°¾å·¥ä½œ">æ”¶å°¾å·¥ä½œ</option>
                            </select>
                        </div>
                        <div class="form-group">
                        <label>æ›´æ–°æ—¥æœŸ</label>
                        <input type="date" class="modal-input" id="progressDate" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group full-width">
                        <label>è¿›åº¦è¯´æ˜</label>
                        <textarea class="modal-input" id="progressDescription" rows="3" placeholder="è¯·æè¿°å½“å‰å®æ–½è¿›å±•ã€é‡åˆ°çš„é—®é¢˜ã€ä¸‹ä¸€æ­¥è®¡åˆ’ç­‰"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
            <button type="button" class="modal-btn modal-btn-cancel">å–æ¶ˆ</button>
            <button type="button" class="modal-btn modal-btn-confirm">æäº¤è¿›åº¦</button>
        </div>
        </div>
    </div>

<!-- å®Œå·¥ç™»è®°å¼¹çª— -->
<div class="modal-overlay" id="completeImplModal" style="display:none;">
    <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
            <h3 class="modal-title">âœ… é¡¹ç›®å®Œå·¥ç™»è®°</h3>
            <button class="modal-close" type="button">Ã—</button>
            </div>
            <div class="modal-body">
            <form id="completeImplForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>é¡¹ç›®ç¼–å·</label>
                        <input type="text" class="modal-input" id="completeProjectNumber" readonly style="background-color:#f5f5f5;">
                            </div>
                            <div class="form-group">
                                <label>é¡¹ç›®åç§°</label>
                        <input type="text" class="modal-input" id="completeProjectName" readonly style="background-color:#f5f5f5;">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                        <label>å®é™…å®Œå·¥æ—¶é—´<span class="required">*</span></label>
                        <input type="date" class="modal-input" id="actualEndDate" required>
                            </div>
                            <div class="form-group">
                        <label>å·¥æœŸå¯¹æ¯”</label>
                        <input type="text" class="modal-input" id="scheduleComparison" readonly style="background-color:#f5f5f5;" placeholder="å°†è‡ªåŠ¨è®¡ç®—">
                            </div>
                            <div class="form-group">
                        <label>å®Œå·¥è´¨é‡</label>
                        <select class="modal-input" id="completionQuality">
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="ä¼˜ç§€">ä¼˜ç§€</option>
                            <option value="è‰¯å¥½">è‰¯å¥½</option>
                            <option value="åˆæ ¼">åˆæ ¼</option>
                            <option value="éœ€æ•´æ”¹">éœ€æ•´æ”¹</option>
                        </select>
                            </div>
                        </div>
                        <div class="form-row">
                    <div class="form-group full-width">
                        <label>å®Œå·¥è¯´æ˜</label>
                        <textarea class="modal-input" id="completionDescription" rows="3" placeholder="è¯·æè¿°å®Œå·¥æƒ…å†µã€é—ç•™é—®é¢˜ã€æ³¨æ„äº‹é¡¹ç­‰"></textarea>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="modal-btn modal-btn-cancel">å–æ¶ˆ</button>
            <button type="button" class="modal-btn modal-btn-confirm">ç¡®è®¤å®Œå·¥</button>
        </div>
    </div>
</div>

<!-- éªŒæ”¶ç™»è®°å¼¹çª— -->
<div class="modal-overlay" id="acceptanceModal" style="display:none;">
    <div class="modal-content" style="max-width: 900px;">
        <div class="modal-header">
            <h3 class="modal-title">ğŸ‰ é¡¹ç›®éªŒæ”¶ç™»è®°</h3>
            <button class="modal-close" type="button">Ã—</button>
        </div>
        <div class="modal-body">
            <form id="acceptanceForm">
                <div class="form-section-title">é¡¹ç›®åŸºæœ¬ä¿¡æ¯</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>é¡¹ç›®ç¼–å·</label>
                        <input type="text" class="modal-input" id="acceptProjectNumber" readonly style="background-color:#f5f5f5;">
                    </div>
                    <div class="form-group">
                        <label>é¡¹ç›®åç§°</label>
                        <input type="text" class="modal-input" id="acceptProjectName" readonly style="background-color:#f5f5f5;">
                    </div>
                </div>
                
                <div class="form-section-title">éªŒæ”¶ä¿¡æ¯<span class="required">*</span></div>
                <div class="form-row">
                    <div class="form-group">
                        <label>éªŒæ”¶æ—¶é—´<span class="required">*</span></label>
                        <input type="date" class="modal-input" id="acceptanceDate" required>
                    </div>
                            <div class="form-group">
                        <label>éªŒæ”¶äºº<span class="required">*</span></label>
                        <input type="text" class="modal-input" id="acceptancePerson" required>
                            </div>
                    <div class="form-group">
                        <label>éªŒæ”¶ç»“æœ<span class="required">*</span></label>
                        <select class="modal-input" id="acceptanceResult" required>
                            <option value="">è¯·é€‰æ‹©</option>
                            <option value="åˆæ ¼">åˆæ ¼</option>
                            <option value="ä¸åˆæ ¼">ä¸åˆæ ¼</option>
                            <option value="æ•´æ”¹ååˆæ ¼">æ•´æ”¹ååˆæ ¼</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-section-title">è´¨ä¿ä¿¡æ¯</div>
                <div class="form-row">
                            <div class="form-group">
                                <label>è´¨ä¿æœŸ</label>
                        <input type="text" class="modal-input" id="warrantyPeriod" placeholder="å¦‚ï¼š2å¹´">
                    </div>
                    <div class="form-group">
                        <label>è´¨ä¿å¼€å§‹æ—¥æœŸ</label>
                        <input type="date" class="modal-input" id="warrantyStartDate">
                    </div>
                    <div class="form-group">
                        <label>è´¨ä¿ç»“æŸæ—¥æœŸ</label>
                        <input type="date" class="modal-input" id="warrantyEndDate">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group full-width">
                        <label>éªŒæ”¶è¯´æ˜</label>
                        <textarea class="modal-input" id="acceptanceRemark" rows="3" placeholder="è¯·è¾“å…¥éªŒæ”¶ç›¸å…³è¯´æ˜ã€å®¢æˆ·åé¦ˆç­‰"></textarea>
                            </div>
                        </div>
                    </form>
            </div>
            <div class="modal-footer">
            <button type="button" class="modal-btn modal-btn-cancel">å–æ¶ˆ</button>
            <button type="button" class="modal-btn modal-btn-confirm">ç¡®è®¤éªŒæ”¶</button>
        </div>
        </div>
    </div>

    <script>
// å®æ–½éƒ¨å·¥ä½œå°åŠŸèƒ½
        (function() {
    'use strict';
    
    window.queryImplementations = function() {
        alert('æŸ¥è¯¢åŠŸèƒ½å¼€å‘ä¸­...');
    };
    
    window.resetFilters = function() {
        document.getElementById('filterProjectNumber').value = '';
        document.getElementById('filterProjectName').value = '';
        document.getElementById('filterImplManager').value = '';
        document.getElementById('filterStatus').value = '';
    };
    
    window.toggleFilters = function() {
        const filters = document.querySelector('.search-filters');
        filters?.classList.toggle('expanded');
    };
    
    window.exportImplementations = function() {
        alert('å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...');
    };
    
    window.refreshData = function() {
        alert('æ•°æ®å·²åˆ·æ–°');
    };
    
    // æŸ¥çœ‹é¡¹ç›®ä¿¡æ¯
    window.viewProjectInfo = function(id) {
        alert('æŸ¥çœ‹é¡¹ç›®ä¿¡æ¯åŠŸèƒ½å¼€å‘ä¸­...');
    };
    
    // å¼€å·¥ç™»è®°
    window.startImplementation = function(id) {
        const row = document.querySelector(`tr[data-id="${id}"]`);
        if (!row) return;
        
        const modal = document.getElementById('startImplModal');
        if (!modal) return;
        
        document.getElementById('startProjectNumber').value = row.cells[1]?.textContent || '';
        document.getElementById('startProjectName').value = row.cells[2]?.textContent || '';
        
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('actualStartDate').value = today;
        
        modal.dataset.projectId = id;
        modal.style.display = 'flex';
    };
    
    // æ›´æ–°è¿›åº¦
    window.updateProgress = function(id) {
        const row = document.querySelector(`tr[data-id="${id}"]`);
        if (!row) return;
        
        const modal = document.getElementById('updateProgressModal');
        if (!modal) return;
        
        document.getElementById('progressProjectNumber').value = row.cells[1]?.textContent || '';
        document.getElementById('progressProjectName').value = row.cells[2]?.textContent || '';
        
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('progressDate').value = today;
        
        modal.dataset.projectId = id;
        modal.style.display = 'flex';
    };
    
    // æŸ¥çœ‹è¿›åº¦è¯¦æƒ…
    window.viewProgressDetail = function(id) {
        alert('è¿›åº¦è¯¦æƒ…æŸ¥çœ‹åŠŸèƒ½å¼€å‘ä¸­...');
    };
    
    // å®Œå·¥ç™»è®°
    window.completeImplementation = function(id) {
        const row = document.querySelector(`tr[data-id="${id}"]`);
        if (!row) return;
        
        const modal = document.getElementById('completeImplModal');
        if (!modal) return;
        
        document.getElementById('completeProjectNumber').value = row.cells[1]?.textContent || '';
        document.getElementById('completeProjectName').value = row.cells[2]?.textContent || '';
        
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('actualEndDate').value = today;
        
        modal.dataset.projectId = id;
        modal.style.display = 'flex';
    };
    
    // éªŒæ”¶ç™»è®°
    window.registerAcceptance = function(id) {
        const row = document.querySelector(`tr[data-id="${id}"]`);
        if (!row) return;
        
        const modal = document.getElementById('acceptanceModal');
        if (!modal) return;
        
        document.getElementById('acceptProjectNumber').value = row.cells[1]?.textContent || '';
        document.getElementById('acceptProjectName').value = row.cells[2]?.textContent || '';
        
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('acceptanceDate').value = today;
        document.getElementById('warrantyStartDate').value = today;
        
        modal.dataset.projectId = id;
        modal.style.display = 'flex';
    };
    
    // æŸ¥çœ‹é¡¹ç›®æ¡£æ¡ˆ
    window.viewProjectArchive = function(id) {
        window.loadPage('pages/project-archive.html', {id: id});
    };
    
    // ä¸‹è½½éªŒæ”¶æŠ¥å‘Š
    window.downloadAcceptanceReport = function(id) {
        alert('éªŒæ”¶æŠ¥å‘Šä¸‹è½½åŠŸèƒ½å¼€å‘ä¸­...');
    };
    
    // å¼¹çª—å…³é—­äº‹ä»¶
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal-close') || e.target.classList.contains('modal-overlay')) {
            const modal = e.target.closest('.modal-overlay') || e.target;
            if (modal && modal.classList.contains('modal-overlay')) {
                modal.style.display = 'none';
            }
        }
        
        if (e.target.classList.contains('modal-btn-confirm')) {
            const modal = e.target.closest('.modal-overlay');
            if (modal) {
                if (modal.id === 'startImplModal') {
                    saveStartImpl();
                } else if (modal.id === 'updateProgressModal') {
                    saveProgress();
                } else if (modal.id === 'completeImplModal') {
                    saveComplete();
                } else if (modal.id === 'acceptanceModal') {
                    saveAcceptance();
                }
            }
        }
        
        if (e.target.classList.contains('modal-btn-cancel')) {
            const modal = e.target.closest('.modal-overlay');
            if (modal) {
                modal.style.display = 'none';
            }
        }
    });
    
    // ä¿å­˜å¼€å·¥ä¿¡æ¯
    function saveStartImpl() {
        const modal = document.getElementById('startImplModal');
        const projectId = modal?.dataset.projectId;
        
        const actualStartDate = document.getElementById('actualStartDate')?.value;
        if (!actualStartDate) {
            alert('è¯·å¡«å†™å®é™…å¼€å·¥æ—¶é—´');
            return;
        }
        
        alert('âœ… å¼€å·¥ç™»è®°æˆåŠŸï¼');
        modal.style.display = 'none';
        
        const row = document.querySelector(`tr[data-id="${projectId}"]`);
        if (row) {
            row.cells[7].textContent = actualStartDate;
            row.cells[10].innerHTML = '<div class="progress-bar-mini" style="width:10%"><span>10%</span></div>';
            row.cells[11].innerHTML = '<span class="status-badge status-implementation">å®æ–½ä¸­</span>';
        }
    }
    
    // ä¿å­˜è¿›åº¦
    function saveProgress() {
        const modal = document.getElementById('updateProgressModal');
        const projectId = modal?.dataset.projectId;
        
        const percent = document.getElementById('progressPercent')?.value;
        if (!percent) {
            alert('è¯·å¡«å†™å½“å‰è¿›åº¦');
            return;
        }
        
        alert('âœ… è¿›åº¦æ›´æ–°æˆåŠŸï¼');
        modal.style.display = 'none';
        
        const row = document.querySelector(`tr[data-id="${projectId}"]`);
        if (row) {
            row.cells[10].innerHTML = `<div class="progress-bar-mini" style="width:${percent}%"><span>${percent}%</span></div>`;
        }
    }
    
    // ä¿å­˜å®Œå·¥ä¿¡æ¯
    function saveComplete() {
        const modal = document.getElementById('completeImplModal');
        const projectId = modal?.dataset.projectId;
        
        const actualEndDate = document.getElementById('actualEndDate')?.value;
        if (!actualEndDate) {
            alert('è¯·å¡«å†™å®é™…å®Œå·¥æ—¶é—´');
            return;
        }
        
        alert('âœ… å®Œå·¥ç™»è®°æˆåŠŸï¼');
        modal.style.display = 'none';
        
        const row = document.querySelector(`tr[data-id="${projectId}"]`);
        if (row) {
            row.cells[9].textContent = actualEndDate;
            row.cells[10].innerHTML = '<div class="progress-bar-mini complete" style="width:100%"><span>100%</span></div>';
            row.cells[11].innerHTML = '<span class="status-badge status-complete">å·²å®Œå·¥</span>';
        }
    };
    
    // ä¿å­˜éªŒæ”¶ä¿¡æ¯
    function saveAcceptance() {
        const modal = document.getElementById('acceptanceModal');
        const projectId = modal?.dataset.projectId;
        
        const acceptanceDate = document.getElementById('acceptanceDate')?.value;
        const acceptancePerson = document.getElementById('acceptancePerson')?.value;
        const acceptanceResult = document.getElementById('acceptanceResult')?.value;
        
        if (!acceptanceDate || !acceptancePerson || !acceptanceResult) {
            alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹');
            return;
        }
        
        alert('âœ… éªŒæ”¶ç™»è®°æˆåŠŸï¼\n\né¡¹ç›®å·²å®Œæˆå…¨éƒ¨æµç¨‹ï¼');
        modal.style.display = 'none';
        
        const row = document.querySelector(`tr[data-id="${projectId}"]`);
        if (row) {
            row.cells[11].innerHTML = '<span class="status-badge status-acceptance">å·²éªŒæ”¶</span>';
        }
            }
        })();
    </script>
